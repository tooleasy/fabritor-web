(self.webpackChunkfabritor_web=self.webpackChunkfabritor_web||[]).push([[767],{2904:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ix},pageConfig:function(){return iZ}});var r,i,o,a,l,s,c,u,h,f,d,p,v,g,m,b=n(7077),y=n(5629),k=n(1010),w=n(8188),Z=n(7582),x=n(7294),C=n(290),_=n(6220),S=n(4909),j=(0,x.createContext)(null),A="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent('<svg t="1699434105329" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6530" width="32" height="32" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M508.018 995.557c-269.887 0-488.675-218.785-488.675-488.675S238.13 18.206 508.018 18.206s488.676 218.787 488.676 488.676c0 269.89-218.788 488.675-488.676 488.675z m0-885.723c-219.283 0-397.048 177.763-397.048 397.048 0 219.284 177.765 397.05 397.048 397.05 219.285 0 397.049-177.766 397.049-397.05 0-219.285-177.764-397.048-397.049-397.048z m206.72 336.247h-87.822c-11.193 0-20.267-9.074-20.267-20.267s9.074-20.267 20.267-20.267h34.905c-31.736-44.89-83.812-74.31-142.994-74.31-97.007 0-175.645 78.638-175.645 175.643 0 11.194-9.074 20.267-20.267 20.267-11.192 0-20.266-9.073-20.266-20.267 0-119.391 96.786-216.177 216.178-216.177 72.505 0 136.49 35.795 175.644 90.603v-36.56c0-11.192 9.073-20.265 20.267-20.265s20.266 9.073 20.266 20.266v81.066c0 11.194-9.073 20.268-20.266 20.268z m-391.822 121.6h87.822c11.193 0 20.266 9.073 20.266 20.266 0 11.193-9.073 20.267-20.266 20.267h-35.18c31.76 44.942 84.035 74.31 143.269 74.31 97.005 0 175.644-78.638 175.644-175.644 0-11.193 9.073-20.266 20.267-20.266s20.266 9.073 20.266 20.266c0 119.392-96.786 216.179-216.177 216.179-72.597 0-136.54-35.95-175.645-90.892v36.847c0 11.193-9.074 20.267-20.267 20.267-11.192 0-20.267-9.074-20.267-20.267v-81.067c0-11.193 9.075-20.266 20.268-20.266z" fill="#515151" p-id="6531"></path></svg>')),O="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent('<svg t="1699434105329" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6530" width="32" height="32" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M508.018 995.557c-269.887 0-488.675-218.785-488.675-488.675S238.13 18.206 508.018 18.206s488.676 218.787 488.676 488.676c0 269.89-218.788 488.675-488.676 488.675z m0-885.723c-219.283 0-397.048 177.763-397.048 397.048 0 219.284 177.765 397.05 397.048 397.05 219.285 0 397.049-177.766 397.049-397.05 0-219.285-177.764-397.048-397.049-397.048z m206.72 336.247h-87.822c-11.193 0-20.267-9.074-20.267-20.267s9.074-20.267 20.267-20.267h34.905c-31.736-44.89-83.812-74.31-142.994-74.31-97.007 0-175.645 78.638-175.645 175.643 0 11.194-9.074 20.267-20.267 20.267-11.192 0-20.266-9.073-20.266-20.267 0-119.391 96.786-216.177 216.178-216.177 72.505 0 136.49 35.795 175.644 90.603v-36.56c0-11.192 9.073-20.265 20.267-20.265s20.266 9.073 20.266 20.266v81.066c0 11.194-9.073 20.268-20.266 20.268z m-391.822 121.6h87.822c11.193 0 20.266 9.073 20.266 20.266 0 11.193-9.073 20.267-20.266 20.267h-35.18c31.76 44.942 84.035 74.31 143.269 74.31 97.005 0 175.644-78.638 175.644-175.644 0-11.193 9.073-20.266 20.267-20.266s20.266 9.073 20.266 20.266c0 119.392-96.786 216.179-216.177 216.179-72.597 0-136.54-35.95-175.645-90.892v36.847c0 11.193-9.074 20.267-20.267 20.267-11.192 0-20.267-9.074-20.267-20.267v-81.067c0-11.193 9.075-20.266 20.268-20.266z" fill="#F50909" p-id="6531"></path></svg>')),z=encodeURIComponent("\n<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='24' height='24'>\n  <defs>\n    <filter id='a' width='266.7%' height='156.2%' x='-75%' y='-21.9%' filterUnits='objectBoundingBox'>\n      <feOffset dy='1' in='SourceAlpha' result='shadowOffsetOuter1'/>\n      <feGaussianBlur in='shadowOffsetOuter1' result='shadowBlurOuter1' stdDeviation='1'/>\n      <feColorMatrix in='shadowBlurOuter1' result='shadowMatrixOuter1' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0'/>\n      <feMerge>\n        <feMergeNode in='shadowMatrixOuter1'/>\n        <feMergeNode in='SourceGraphic'/>\n      </feMerge>\n    </filter>\n    <path id='b' d='M1.67 12.67a7.7 7.7 0 0 0 0-9.34L0 5V0h5L3.24 1.76a9.9 9.9 0 0 1 0 12.48L5 16H0v-5l1.67 1.67z'/>\n  </defs>\n  <g fill='none' fill-rule='evenodd'><path d='M0 24V0h24v24z'/>\n    <g fill-rule='nonzero' filter='url(#a)' transform='rotate(90 5.25 14.75)'>\n      <use fill='#000' fill-rule='evenodd' xlink:href='#b'/>\n      <path stroke='#FFF' d='M1.6 11.9a7.21 7.21 0 0 0 0-7.8L-.5 6.2V-.5h6.7L3.9 1.8a10.4 10.4 0 0 1 0 12.4l2.3 2.3H-.5V9.8l2.1 2.1z'/>\n    </g>\n  </g>\n</svg>"),F="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent('<svg t="1702138272519" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16833" width="32" height="32"><path d="M810.666667 85.333333a85.333333 85.333333 0 0 1 85.333333 85.333334v512a85.333333 85.333333 0 0 1-85.333333 85.333333h-85.333334v85.333333a85.333333 85.333333 0 0 1-85.333333 85.333334H213.333333a85.333333 85.333333 0 0 1-85.333333-85.333334V341.333333a85.333333 85.333333 0 0 1 85.333333-85.333333h85.333334V170.666667a85.333333 85.333333 0 0 1 85.333333-85.333334h426.666667z m-384 554.666667H341.333333a42.666667 42.666667 0 0 0-4.992 85.034667L341.333333 725.333333h85.333334a42.666667 42.666667 0 0 0 4.992-85.034666L426.666667 640z m384-469.333333H384v85.333333h256a85.333333 85.333333 0 0 1 85.333333 85.333333v341.333334h85.333334V170.666667z m-298.666667 298.666666H341.333333a42.666667 42.666667 0 1 0 0 85.333334h170.666667a42.666667 42.666667 0 1 0 0-85.333334z" p-id="16834" fill="#515151"></path></svg>')),R="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent('<svg t="1702138272519" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16833" width="32" height="32"><path d="M810.666667 85.333333a85.333333 85.333333 0 0 1 85.333333 85.333334v512a85.333333 85.333333 0 0 1-85.333333 85.333333h-85.333334v85.333333a85.333333 85.333333 0 0 1-85.333333 85.333334H213.333333a85.333333 85.333333 0 0 1-85.333333-85.333334V341.333333a85.333333 85.333333 0 0 1 85.333333-85.333333h85.333334V170.666667a85.333333 85.333333 0 0 1 85.333333-85.333334h426.666667z m-384 554.666667H341.333333a42.666667 42.666667 0 0 0-4.992 85.034667L341.333333 725.333333h85.333334a42.666667 42.666667 0 0 0 4.992-85.034666L426.666667 640z m384-469.333333H384v85.333333h256a85.333333 85.333333 0 0 1 85.333333 85.333333v341.333334h85.333334V170.666667z m-298.666667 298.666666H341.333333a42.666667 42.666667 0 1 0 0 85.333334h170.666667a42.666667 42.666667 0 1 0 0-85.333334z" p-id="16834" fill="#d81e06"></path></svg>')),B="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent('<svg t="1702138440243" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="19137" width="32" height="32"><path d="M853.333333 192v42.666667a21.333333 21.333333 0 0 1-21.333333 21.333333h-640a21.333333 21.333333 0 0 1-21.333333-21.333333v-42.666667a21.333333 21.333333 0 0 1 21.333333-21.333333H384V128a42.666667 42.666667 0 0 1 42.666667-42.666667h170.666666a42.666667 42.666667 0 0 1 42.666667 42.666667v42.666667h192a21.333333 21.333333 0 0 1 21.333333 21.333333zM250.453333 859.306667a85.333333 85.333333 0 0 0 85.333334 79.36h353.28a85.333333 85.333333 0 0 0 85.333333-79.36L810.666667 341.333333H213.333333z" p-id="19138" fill="#515151"></path></svg>')),P="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent('<svg t="1702138440243" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="19137" width="32" height="32"><path d="M853.333333 192v42.666667a21.333333 21.333333 0 0 1-21.333333 21.333333h-640a21.333333 21.333333 0 0 1-21.333333-21.333333v-42.666667a21.333333 21.333333 0 0 1 21.333333-21.333333H384V128a42.666667 42.666667 0 0 1 42.666667-42.666667h170.666666a42.666667 42.666667 0 0 1 42.666667 42.666667v42.666667h192a21.333333 21.333333 0 0 1 21.333333 21.333333zM250.453333 859.306667a85.333333 85.333333 0 0 0 85.333334 79.36h353.28a85.333333 85.333333 0 0 0 85.333333-79.36L810.666667 341.333333H213.333333z" p-id="19138" fill="#d81e06"></path></svg>')),L='<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4941" width="22" height="22"><path d="M630.57970569 637.6867208l110.35938764 236.66748681c6.20083831 13.29490805 0.44014302 29.08827497-12.84181964 35.28911328l-96.26186588 44.88164187c-13.29490805 6.20083831-29.08827497 0.45308839-35.28911329-12.84181965l-112.87079191-242.05276602-138.77450271 138.77450272c-10.36925155 10.36925155-27.17235831 10.36925155-37.54160987 0.01294537a26.56392533 26.56392533 0 0 1-7.78017501-18.78375032V147.18616969c0-14.66711861 11.88386133-26.55097995 26.55097995-26.55097996 6.60214518 0 12.97127348 2.45962272 17.86462814 6.89988899l494.18998519 449.26950715c10.84823072 9.86438163 11.65084445 26.65454302 1.78646281 37.50277374a26.56004172 26.56004172 0 0 1-17.6057205 8.6086795L630.57970569 637.6867208z" p-id="4942" fill="#2c2c2c"></path></svg>',X="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 44L12 40L16 44L20 38L24 44L28 38L32 44L36 40L40 44V20C40 11.1634 32.8366 4 24 4C15.1634 4 8 11.1634 8 20V44Z" fill="none" stroke="#000000" stroke-width="4" stroke-linejoin="round"/><path d="M19 20H21" stroke="#000000" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M31 20H33" stroke="#000000" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>')),M=n(9790),E=n(5692),H=n(665),W=n(1181),T=n(9810),I=n(2253),J=n(4932),V=n(9210),U=n(2641);function Y(e){var t=e.children,n=e.height,r=void 0===n?46:n,i=e.style,o=(0,V._)(e,["children","height","style"]);return(0,b.tZ)(U.Z,(0,J._)((0,I._)({justify:"center",align:"center"},o),{style:(0,I._)({height:r},i),children:t}))}var D=function(e){return(0,b.tZ)(Y,(0,I._)({justify:"normal"},e))},N=n(384);function G(e){var t=e.onClick,n=e.title,r=e.disabled,i=e.tooltipProps,o=e.children;return(0,b.tZ)(N.Z,(0,J._)((0,I._)({placement:"bottom",title:(0,b.tZ)("span",{style:{fontSize:12},children:n})},i),{children:(0,b.tZ)("span",{className:"fabritor-toolbar-item",style:{color:r?"#cccccc":"rgba(0, 0, 0, 0.88)"},onClick:function(){r||null==t||t()},children:o})}))}var q=n(8697);function K(){return(0,b.tZ)(q.Z,{type:"vertical",style:{height:32}})}var $=n(97),Q=n(5006),ee=function(e){return $.Z.t(e)},et="header.toolbar";function en(){var e=(0,x.useContext)(j),t=e.setActiveObject,n=e.editor,r=(0,w._)((0,x.useState)(!1),2),i=r[0],o=r[1],a=(0,w._)((0,x.useState)(!1),2),l=a[0],s=a[1],c=(0,w._)((0,x.useState)(!1),2),u=c[0],h=c[1];return(0,x.useEffect)(function(){n&&(s(n.fhistory.canUndo()),h(n.fhistory.canRedo()))}),(0,b.BX)(D,{gap:4,style:{borderRight:"1px solid #e8e8e8",paddingRight:12},children:[(0,b.tZ)(G,{disabled:!l,title:(0,b.tZ)(Q.cC,{i18nKey:"".concat(et,".undo")}),onClick:function(){n.fhistory.undo()},children:(0,b.tZ)(E.Z,{style:{fontSize:20}})}),(0,b.tZ)(G,{disabled:!u,title:(0,b.tZ)(Q.cC,{i18nKey:"".concat(et,".redo")}),onClick:function(){n.fhistory.redo()},children:(0,b.tZ)(H.Z,{style:{fontSize:20}})}),(0,b.tZ)(K,{}),(0,b.tZ)(G,{onClick:function(){o(n.switchEnablePan())},title:i?(0,b.tZ)(Q.cC,{i18nKey:"".concat(et,".select")}):(0,b.tZ)(Q.cC,{i18nKey:"".concat(et,".pan")}),children:i?(0,b.tZ)(W.Z,{style:{fontSize:22,color:i?"#000":"#ccc"}}):(0,b.tZ)("img",{src:"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(L)),style:{width:22,height:22}})}),(0,b.tZ)(G,{onClick:function(){S.Z.confirm({title:(0,b.tZ)(Q.cC,{i18nKey:"".concat(et,".clear_confirm")}),icon:(0,b.tZ)(M.Z,{}),onOk(){return(0,k._)(function(){return(0,Z.Jh)(this,function(e){switch(e.label){case 0:return[4,n.clearCanvas()];case 1:return e.sent(),t(n.sketch),n.fireCustomModifiedEvent(),[2]}})})()}})},title:(0,b.tZ)(Q.cC,{i18nKey:"".concat(et,".clear")}),children:(0,b.tZ)(T.Z,{style:{fontSize:20}})})]})}var er=n(7008),ei=n(6372),eo=n(495),ea=n(8334),el=n(53),es=n(1861),ec=n(1197),eu=n(6880),eh="fabritor_schema_version",ef="".concat("fabritor","_log\uFF1A"),ed={borderColor:"#FF2222",borderScaleFactor:2,cornerStrokeColor:"#2222",cornerColor:"#FF2222",cornerSize:12,cornerStyle:"circle",transparentCorners:!1,padding:0,centeredScaling:!1,strokeUniform:!0,paintFirst:"stroke"},ep={fill:"#000000",fontWeight:"normal",fontSize:50,lineHeight:1.3,textAlign:"center",fontFamily:"AlibabaPuHuiTi",width:500,splitByGrapheme:!0},ev=[{label:(0,b.tZ)("span",{style:{fontFamily:"SmileySans",fontSize:16},children:"\u5F97\u610F\u9ED1"}),value:"SmileySans"},{label:(0,b.tZ)("span",{style:{fontFamily:"\u971E\u9E5C\u65B0\u6670\u9ED1",fontSize:16},children:"\u971E\u9E5C\u65B0\u6670\u9ED1"}),value:"\u971E\u9E5C\u65B0\u6670\u9ED1"},{label:(0,b.tZ)("span",{style:{fontFamily:"\u971E\u9E5C\u6587\u6977",fontSize:16},children:"\u971E\u9E5C\u6587\u6977"}),value:"\u971E\u9E5C\u6587\u6977"},{label:(0,b.tZ)("span",{style:{fontFamily:"\u5C0F\u8D56\u5B57\u4F53",fontSize:16},children:"\u5C0F\u8D56\u5B57\u4F53"}),value:"\u5C0F\u8D56\u5B57\u4F53"},{label:(0,b.tZ)("span",{style:{fontFamily:"\u60A0\u54C9\u5B57\u4F53",fontSize:16},children:"\u60A0\u54C9\u5B57\u4F53"}),value:"\u60A0\u54C9\u5B57\u4F53"},{label:(0,b.tZ)("span",{style:{fontFamily:"AlibabaPuHuiTi",fontSize:16},children:"\u963F\u91CC\u5DF4\u5DF4\u666E\u60E0\u4F53"}),value:"AlibabaPuHuiTi"},{label:(0,b.tZ)("span",{style:{fontFamily:"\u971E\u9E5C\u5C1A\u667A\u9ED1",fontSize:16},children:"\u971E\u9E5C\u5C1A\u667A\u9ED1"}),value:"\u971E\u9E5C\u5C1A\u667A\u9ED1"},{label:(0,b.tZ)("span",{style:{fontFamily:"SourceHanSans",fontSize:16},children:"\u601D\u6E90\u9ED1\u4F53"}),value:"SourceHanSans"},{label:(0,b.tZ)("span",{style:{fontFamily:"SourceHanSerif",fontSize:16},children:"\u601D\u6E90\u5B8B\u4F53"}),value:"SourceHanSerif"},{label:(0,b.tZ)("span",{style:{fontFamily:"\u65B9\u6B63\u6977\u4F53",fontSize:16},children:"\u65B9\u6B63\u6977\u4F53"}),value:"\u65B9\u6B63\u6977\u4F53"},{label:(0,b.tZ)("span",{style:{fontFamily:"\u5305\u56FE\u5C0F\u767D\u4F53",fontSize:16},children:"\u5305\u56FE\u5C0F\u767D\u4F53"}),value:"\u5305\u56FE\u5C0F\u767D\u4F53"},{label:(0,b.tZ)("span",{style:{fontFamily:"\u624B\u5199\u6742\u5B57\u4F53",fontSize:16},children:"\u624B\u5199\u6742\u5B57\u4F53"}),value:"\u624B\u5199\u6742\u5B57\u4F53"},{label:(0,b.tZ)("span",{style:{fontFamily:"\u80E1\u6653\u6CE2\u7537\u795E\u4F53",fontSize:16},children:"\u80E1\u6653\u6CE2\u7537\u795E\u4F53"}),value:"\u80E1\u6653\u6CE2\u7537\u795E\u4F53"},{label:(0,b.tZ)("span",{style:{fontFamily:"\u80E1\u6653\u6CE2\u9A9A\u5305\u4F53",fontSize:16},children:"\u80E1\u6653\u6CE2\u9A9A\u5305\u4F53"}),value:"\u80E1\u6653\u6CE2\u9A9A\u5305\u4F53"},{label:(0,b.tZ)("span",{style:{fontFamily:"\u7AD9\u9177\u5FEB\u4E50\u4F53",fontSize:16},children:"\u7AD9\u9177\u5FEB\u4E50\u4F53"}),value:"\u7AD9\u9177\u5FEB\u4E50\u4F53"},{label:(0,b.tZ)("span",{style:{fontFamily:"\u7AD9\u9177\u6587\u827A\u4F53",fontSize:16},children:"\u7AD9\u9177\u6587\u827A\u4F53"}),value:"\u7AD9\u9177\u6587\u827A\u4F53"},{label:(0,b.tZ)("span",{style:{fontFamily:"\u7AD9\u9177\u5C0F\u8587LOGO\u4F53",fontSize:16},children:"\u7AD9\u9177\u5C0F\u8587LOGO\u4F53"}),value:"\u7AD9\u9177\u5C0F\u8587LOGO\u4F53"}],eg="fabritor-sketch",em=["id","fabritor_desc","selectable","hasControls","sub_type","imageSource","imageBorder","oldArrowInfo"],eb=(r=(0,k._)(function(e){return(0,Z.Jh)(this,function(t){return e&&ev.find(function(t){return t.value===e})?[2,new ec(e).load(null,1e5).catch(function(e){console.error(ef,e)})]:[2,Promise.resolve()]})}),function(e){return r.apply(this,arguments)}),ey=function(){return(0,eu.Z)()},ek=function(e,t,n){var r=document.createElement("a");r.href=e,r.download="".concat(n||ey(),".").concat(t),document.body.appendChild(r),r.click(),document.body.removeChild(r)},ew={45:JSON.stringify({x1:0,y1:1,x2:1,y2:0}),90:JSON.stringify({x1:0,y1:0,x2:1,y2:0}),135:JSON.stringify({x1:0,y1:0,x2:1,y2:1}),180:JSON.stringify({x1:0,y1:0,x2:0,y2:1}),225:JSON.stringify({x1:1,y1:0,x2:0,y2:1}),270:JSON.stringify({x1:1,y1:0,x2:0,y2:0}),315:JSON.stringify({x1:1,y1:1,x2:0,y2:0}),0:JSON.stringify({x1:0,y1:1,x2:0,y2:0})},eZ=function(e){var t=Object.keys(ew),n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,s=(0,I._)({},e);if(s={x1:e.x1>1?1:0,y1:e.y1>1?1:0,x2:e.x2>1?1:0,y2:e.y2>1?1:0},JSON.stringify(s)===ew[l])return Number(l)}}catch(c){r=!0,i=c}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return 90},ex=function(e){return!e||"string"==typeof e||e instanceof es.fabric.Pattern?{type:"solid",color:e||"#ffffff"}:{type:e.type,gradient:{colorStops:e.colorStops,angle:eZ(e.coords)}}},eC=function(e){var t;switch(null==e?void 0:e.type){case"solid":t=e.color;break;case"linear":t={type:"linear",gradientUnits:"percentage",coords:JSON.parse(ew[e.gradient.angle%360]||ew[90]),colorStops:e.gradient.colorStops};break;case"radial":t={type:"radial",gradientUnits:"percentage",coords:{x1:.5,y1:.5,x2:.5,y2:.5,r1:0,r2:1},colorStops:e.gradient.colorStops}}return t},e_=(i=(0,k._)(function(e,t){var n;return(0,Z.Jh)(this,function(r){return(n=0===t.indexOf("text")?"text":0===t.indexOf("image/")?"image":"")?[2,new Promise(function(t){var r=new FileReader;r.onload=function(e){var r;t({type:n,result:null===(r=e.target)||void 0===r?void 0:r.result})},r.onerror=function(e){console.log(e),t(null)},"text"===n?r.readAsText(e):"image"===n&&r.readAsDataURL(e)})]:[2,Promise.resolve(null)]})}),function(e,t){return i.apply(this,arguments)}),eS=(o=(0,k._)(function(){var e,t,n,r,i,o,a,l,s,c,u,h,f,d,p,v;return(0,Z.Jh)(this,function(g){switch(g.label){case 0:return g.trys.push([0,17,,18]),[4,navigator.clipboard.read()];case 1:e=g.sent(),t=!0,n=!1,r=void 0,g.label=2;case 2:g.trys.push([2,14,15,16]),i=e[Symbol.iterator](),g.label=3;case 3:if(t=(o=i.next()).done)return[3,13];a=o.value,l=!0,s=!1,c=void 0,g.label=4;case 4:g.trys.push([4,10,11,12]),u=a.types[Symbol.iterator](),g.label=5;case 5:if(l=(h=u.next()).done)return[3,9];return f=h.value,[4,a.getType(f)];case 6:return[4,e_.apply(void 0,[g.sent(),f])];case 7:if(d=g.sent())return[2,d];g.label=8;case 8:return l=!0,[3,5];case 9:return[3,12];case 10:return p=g.sent(),s=!0,c=p,[3,12];case 11:try{l||null==u.return||u.return()}finally{if(s)throw c}return[7];case 12:return t=!0,[3,3];case 13:return[3,16];case 14:return p=g.sent(),n=!0,r=p,[3,16];case 15:try{t||null==i.return||i.return()}finally{if(n)throw r}return[7];case 16:return[2,null];case 17:return console.error((v=g.sent()).name,v.message),[2,null];case 18:return[2]}})}),function(){return o.apply(this,arguments)}),ej=(a=(0,k._)(function(e){return(0,Z.Jh)(this,function(t){return[2,fetch(e).then(function(e){return e.blob()})]})}),function(e){return a.apply(this,arguments)}),eA=(0,x.forwardRef)(function(e,t){var n=e.onChange,r=e.accept,i=(0,x.useRef)(null),o=(0,x.useRef)(null);return(0,x.useImperativeHandle)(t,function(){return{start:function(){var e,t;null===(t=o.current)||void 0===t||null===(e=t.click)||void 0===e||e.call(t)},reset:function(){var e,t;null===(t=i.current)||void 0===t||null===(e=t.reset)||void 0===e||e.call(t)}}}),(0,b.tZ)("form",{style:{display:"none"},ref:i,children:(0,b.tZ)("input",{type:"file",accept:r||"image/*",ref:o,onChange:function(e){var t,r;e.target.files[0]&&(n&&n(e.target.files[0]),null===(r=i.current)||void 0===r||null===(t=r.reset)||void 0===t||t.call(r))}})})}),eO="header.export",ez=["jpg","png","svg","json","divider","clipboard"].map(function(e){return"divider"===e?{type:"divider"}:{key:e,label:(0,b.tZ)(Q.cC,{i18nKey:"".concat(eO,".").concat(e)})}});function eF(){var e,t=(0,x.useContext)(j),n=t.editor,r=t.setReady,i=t.setActiveObject,o=(0,x.useRef)(),a=(0,Q.$G)().t,l=(e=(0,k._)(function(){var e;return(0,Z.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,ej(n.export2Img({format:"png"}))];case 1:return e=t.sent(),[4,navigator.clipboard.write([new ClipboardItem({"image/png":e})])];case 2:return t.sent(),er.ZP.success(translate("".concat(eO,".copy_success"))),[3,4];case 3:return t.sent(),er.ZP.error(translate("".concat(eO,".copy_fail"))),[3,4];case 4:return[2]}})}),function(){return e.apply(this,arguments)});return(0,b.BX)(D,{justify:"flex-end",gap:16,style:{width:280,paddingRight:16},children:[(0,b.tZ)(ei.ZP,{onClick:function(){var e,t;null===(t=o.current)||void 0===t||null===(e=t.start)||void 0===e||e.call(t)},icon:(0,b.tZ)(ea.Z,{}),children:a("".concat(eO,".load"))}),(0,b.tZ)(eo.Z,{menu:{items:ez,onClick:function(e){var t=e.key,r=n.sketch.fabritor_desc;switch(t){case"png":ek(n.export2Img({format:"png"}),"png",r);break;case"jpg":ek(n.export2Img({format:"jpeg"}),"jpg",r);break;case"svg":ek(n.export2Svg(),"svg",r);break;case"json":var i=n.canvas2Json();ek("data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(i,null,2))),"json",r);break;case"clipboard":l()}}},arrow:{pointAtCenter:!0},placement:"bottom",children:(0,b.tZ)(ei.ZP,{type:"primary",icon:(0,b.tZ)(el.Z,{}),children:a("".concat(eO,".export"))})}),(0,b.tZ)(eA,{accept:"application/json",ref:o,onChange:function(e){r(!1);var t,o=new FileReader;o.onload=(t=(0,k._)(function(e){var t,o;return(0,Z.Jh)(this,function(a){switch(a.label){case 0:if(!(o=null===(t=e.target)||void 0===t?void 0:t.result))return[3,2];return[4,n.loadFromJSON(o,!0)];case 1:a.sent(),n.fhistory.reset(),r(!0),i(null),n.fireCustomModifiedEvent(),a.label=2;case 2:return[2]}})}),function(e){return t.apply(this,arguments)}),o.readAsText(e)}})]})}function eR(){return(0,b.BX)(D,{gap:5,style:{width:360,paddingLeft:16},children:[(0,b.tZ)("img",{src:X,style:{width:28}}),(0,b.tZ)("span",{style:{fontWeight:"bold",fontSize:14},children:"fabritor, A creative editor based on fabricjs."})]})}var eB=n(9752),eP=eB.Z.Text;function eL(){var e=(0,w._)((0,x.useState)(""),2),t=e[0],n=e[1],r=(0,x.useContext)(j).editor,i=(0,Q.$G)().t;return(0,x.useEffect)(function(){r&&n(r.sketch.fabritor_desc)},[null==r?void 0:r.sketch]),(0,b.tZ)(eP,{editable:{onChange:function(e){var t=e||i("header.fabritor_desc");n(t),r&&(r.sketch.set("fabritor_desc",t),r.fireCustomModifiedEvent())},autoSize:{minRows:1,maxRows:1}},ellipsis:{rows:1},style:{margin:0,width:200},children:t||""})}var eX=C.Z.Header,eM={padding:0,height:50,backgroundColor:"#fff",display:"flex",alignItems:"center",borderBottom:"1px solid #e8e8e8"};function eE(){return(0,b.BX)(eX,{style:eM,children:[(0,b.tZ)(eR,{}),(0,b.BX)(D,{justify:"space-between",style:{flex:1},children:[(0,b.tZ)(eL,{}),(0,b.tZ)(en,{})]}),(0,b.tZ)(eF,{})]})}var eH=n(9548),eW=n(4307),eT=n(6831),eI=n(7744),eJ=n(7822),eV=n(5303),eU=n(8599),eY=n(8586),eD=n(8021),eN=n(3831);function eG(e){var t=e.children;return(0,b.tZ)(q.Z,{children:t})}var eq=[{label:(0,b.tZ)("div",{style:{fontSize:30,fontFamily:"SmileySans",fontWeight:"bold"},children:(0,b.tZ)(Q.cC,{i18nKey:"panel.text.add_title"})}),key:"title",config:{fontFamily:"SmileySans",fontWeight:"bold",fontSize:120,text:function(){return ee("panel.text.add_title")},top:100}},{label:(0,b.tZ)("div",{style:{fontSize:24,fontFamily:"AlibabaPuHuiTi"},children:(0,b.tZ)(Q.cC,{i18nKey:"panel.text.add_subtitle"})}),key:"sub-title",config:{fontFamily:"AlibabaPuHuiTi",fontWeight:"bold",fontSize:100,text:function(){return ee("panel.text.add_subtitle")},top:400}},{label:(0,b.tZ)("div",{style:{fontSize:16,fontFamily:"SourceHanSerif"},children:(0,b.tZ)(Q.cC,{i18nKey:"panel.text.add_body_text"})}),key:"content",config:{fontFamily:"SourceHanSerif",fontSize:80,text:function(){return ee("panel.text.add_body_text")}}},{label:(0,b.tZ)("div",{style:{fontSize:26,fontFamily:"\u971E\u9E5C\u6587\u6977",color:"#ffffff",WebkitTextStroke:"1px rgb(255, 87, 87)"},children:(0,b.tZ)(Q.cC,{i18nKey:"panel.text.add_text_border"})}),key:"content",config:{fontFamily:"\u971E\u9E5C\u6587\u6977",fontSize:100,text:function(){return ee("panel.text.add_text_border")},fill:"#ffffff",stroke:"#ff5757",strokeWidth:12}}];function eK(e){var t=e.addTextBox,n=(0,Q.$G)().t,r=function(e){null==t||t(e.config)};return(0,b.BX)(U.Z,{vertical:!0,gap:8,style:{marginTop:16},children:[(0,b.tZ)(eG,{children:n("panel.text.presets")}),eq.map(function(e){return(0,b.tZ)(eN.Z,{hoverable:!0,onClick:function(){r(e)},bodyStyle:{padding:"12px 30px"},children:e.label},e.key)})]})}var e$=function(e){var t=e.textLines||[];if(!t||!t.length)return 0;for(var n=0,r=0;r<t.length;r++)n+=e.measureLine(r).width;return n+4},eQ=function(e){if(!e.path)return 100;var t=Math.ceil(e.path.path[1][2]/(e$(e)/2)*100);return t>100?100:t},e0=function(e,t){if(!e.isEditing){var n=e$(e),r=new es.fabric.Path("M 0 0 Q ".concat(n/2," ").concat(n/2*t/100," ").concat(n," 0"),{visible:!1,stroke:"#000000",fill:"#00000000"});e.set({path:r,width:n}),e.canvas.requestRenderAll()}},e1=function(e){e.set({path:null}),e.canvas.requestRenderAll()},e2=(l=(0,k._)(function(e){var t,n,r,i,o,a,l,s,c;return(0,Z.Jh)(this,function(u){switch(u.label){case 0:if(r=void 0===(n=(t=e||{}).text)?"":n,o=void 0===(i=t.fontFamily)?ep.fontFamily:i,a=t.canvas,l=(0,V._)(t,["text","fontFamily","canvas"]),"function"==typeof r&&(r=r()),s={hasPath:!1,offset:100},(c=new es.fabric.FText(r||ee("panel.text.add"),(0,J._)((0,I._)({},ep,l),{fontFamily:o,pathAlign:"center",id:ey()}))).on("editing:entered",function(){c.path?(s.hasPath=!0,s.offset=eQ(c),c.set("path",null),c.initDimensions(),a.requestRenderAll()):s.hasPath=!1}),c.on("editing:exited",function(){s.hasPath&&(e0(c,s.offset),a.requestRenderAll())}),null==e.left&&null==e.top?a.viewportCenterObject(c):null==e.left&&a.viewportCenterObjectH(c),a.add(c),a.setActiveObject(c),a.requestRenderAll(),!o)return[3,4];u.label=1;case 1:return u.trys.push([1,,3,4]),[4,eb(o)];case 2:return u.sent(),[3,4];case 3:return c.set("fontFamily",o),a.requestRenderAll(),[7];case 4:return[2,c]}})}),function(e){return l.apply(this,arguments)});function e3(){var e,t=(0,x.useContext)(j).editor,n=(0,Q.$G)().t,r=(e=(0,k._)(function(e){return(0,Z.Jh)(this,function(n){switch(n.label){case 0:return[4,e2((0,J._)((0,I._)({},e),{canvas:t.canvas}))];case 1:return n.sent(),[2]}})}),function(t){return e.apply(this,arguments)});return(0,b.BX)("div",{className:"fabritor-panel-wrapper",children:[(0,b.tZ)(ei.ZP,{type:"primary",block:!0,onClick:function(){r({})},size:"large",children:n("panel.text.add")}),(0,b.tZ)(eK,{addTextBox:r})]})}var e6=(s=(0,k._)(function(e){return(0,Z.Jh)(this,function(t){return[2,new Promise(function(t,n){es.fabric.util.loadImage(e,function(e){return e?t(e):(er.ZP.error("\u52A0\u8F7D\u56FE\u7247\u5931\u8D25"),n())},null,"anonymous")})]})}),function(e){return s.apply(this,arguments)}),e4=(c=(0,k._)(function(e){return(0,Z.Jh)(this,function(t){return"string"==typeof e?[2,new Promise(function(t,n){es.fabric.Image.fromURL(e,function(e){if(!e){er.ZP.error("\u52A0\u8F7D\u56FE\u7247\u5931\u8D25"),n();return}t(e)},{crossOrigin:"anonymous"})})]:[2,Promise.resolve(new es.fabric.Image(e))]})}),function(e){return c.apply(this,arguments)}),e8=(u=(0,k._)(function(e){var t,n,r,i,o;return(0,Z.Jh)(this,function(a){switch(a.label){case 0:n=(t=e||{}).imageSource,r=t.canvas,i=(0,V._)(t,["imageSource","canvas"]),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,e4(n)];case 2:return o=a.sent(),[3,4];case 3:return console.log(a.sent()),[3,4];case 4:if(!o)return[2];return o.set((0,J._)((0,I._)({},i),{paintFirst:"fill",id:ey()})),r.viewportCenterObject(o),r.add(o),r.setActiveObject(o),r.requestRenderAll(),[2,o]}})}),function(e){return u.apply(this,arguments)}),e5=(h=(0,k._)(function(e){var t,n,r,i,o;return(0,Z.Jh)(this,function(a){switch(a.label){case 0:n=(t=e||{}).imageSource,r=t.canvas,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,e4(n)];case 2:return i=a.sent(),[3,4];case 3:return console.log(a.sent()),[3,4];case 4:if(!i)return[2];return o=new es.fabric.FImage({image:i,id:ey()}),r.viewportCenterObject(o),r.add(o),r.setActiveObject(o),r.requestRenderAll(),[2]}})}),function(e){return h.apply(this,arguments)});function e7(e){var t=e.onChange,n=(0,V._)(e,["onChange"]),r=(0,x.useRef)(),i=(0,Q.$G)().t;return(0,b.BX)("div",{children:[(0,b.tZ)(ei.ZP,(0,J._)((0,I._)({type:"primary",size:"large",onClick:function(){var e,t;null===(t=r.current)||void 0===t||null===(e=t.start)||void 0===e||e.call(t)}},n),{children:i("panel.image.local")})),(0,b.tZ)(eA,{accept:"image/*",ref:r,onChange:function(e){if("image/svg+xml"!==e.type){var n=new FileReader;n.onload=function(e){null==t||t(e.target.result)},n.readAsDataURL(e)}}})]})}var e9=n(3136),te=n(2313),tt=n(2950);function tn(e){var t=e.onChange,n=(0,V._)(e,["onChange"]),r=(0,w._)((0,x.useState)(""),2),i=r[0],o=r[1],a=(0,Q.$G)().t;return(0,b.tZ)(e9.Z,{content:(0,b.BX)(te.Z.Compact,{children:[(0,b.tZ)(tt.Z,{value:i,onChange:function(e){o(e.target.value)},style:{width:260}}),(0,b.tZ)(ei.ZP,{onClick:function(){i&&(null==t||t(i))},children:a("common.ok")})]}),title:a("panel.image.remote_placeholder"),trigger:"click",children:(0,b.tZ)(ei.ZP,(0,J._)((0,I._)({type:"primary",size:"large"},n),{children:a("panel.image.remote")}))})}function tr(e){var t=e.onChange,n=(0,V._)(e,["onChange"]);return(0,b.BX)(U.Z,{gap:10,justify:"space-around",children:[(0,b.tZ)(e7,(0,J._)((0,I._)({},n),{onChange:t})),(0,b.tZ)(tn,(0,J._)((0,I._)({},n),{onChange:t}))]})}function ti(){var e,t=(0,x.useContext)(j).editor,n=(e=(0,k._)(function(e){return(0,Z.Jh)(this,function(n){switch(n.label){case 0:return[4,e5({imageSource:e,canvas:t.canvas})];case 1:return n.sent(),[2]}})}),function(t){return e.apply(this,arguments)});return(0,b.tZ)("div",{className:"fabritor-panel-wrapper",children:(0,b.tZ)(tr,{onChange:n})})}var to=n(6546),ta=[{key:"line",type:"f-line",svg:'<svg xmlns="http://www.w3.org/2000/svg" stroke="rgb(44, 44, 44)" fill="rgb(44, 44, 44)" viewBox="0 -0.5 33 1"><line x1="0.5" x2="32.5" stroke-linecap="butt" fill="none"></line></svg>'},{key:"dash-line",type:"f-line",svg:'<svg xmlns="http://www.w3.org/2000/svg" stroke="rgb(44, 44, 44)" fill="rgb(44, 44, 44)" viewBox="0 -0.5 33 1"><line x1="0.5" x2="32.5" stroke-dasharray="3,1" stroke-linecap="butt" fill="none"></line></svg>',options:{strokeDashArray:[8,8]}},{key:"arrow-line-1",type:"f-arrow",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 40" stroke="rgb(44, 44, 44)" fill="rgb(44, 44, 44)">\n    <line x1="0" x2="51" y1="20" y2="20" stroke-linecap="butt" fill="none" strokeWidth="4" />\n    <path d="M 51 20 V 23 L 56 20 L 51 17 Z"></path></svg>'},{key:"arrow-line-2",type:"f-tri-arrow",svg:'<svg xmlns="http://www.w3.org/2000/svg" stroke="rgb(44, 44, 44)" fill="rgb(44, 44, 44)" viewBox="0 -0.5 33 1"><line x1="0.5" x2="32.25" stroke-linecap="butt" fill="none"></line><g transform="translate(33)"><path fill="none" stroke-linecap="round" stroke-linejoin="round" d="M -2.5,-1.5,-0.5,0,-2.5,1.5"></path></g></svg>'}],tl=function(e){return Math.PI*e/180},ts=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=360/e,r=[],i=0;i<e;i++){var o=t*Math.cos(tl(i*n)),a=t*Math.sin(tl(i*n));r.push({x:-a,y:-o})}return r},tc=[{key:"rect",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M42 6H6V42H42V6Z" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:es.fabric.Rect,options:{width:200,height:200,fill:"#555555"}},{key:"rect-r",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M39 6H9C7.34315 6 6 7.34315 6 9V39C6 40.6569 7.34315 42 9 42H39C40.6569 42 42 40.6569 42 39V9C42 7.34315 40.6569 6 39 6Z" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:es.fabric.Rect,options:{width:200,height:200,rx:20,ry:20,fill:"#555555"}},{key:"circle",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="24" cy="24" r="20" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:es.fabric.Circle,options:{radius:100,fill:"#555555"}},{key:"ellipse",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><ellipse cx="24" cy="24" rx="14" ry="20" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:es.fabric.Ellipse,options:{rx:120,ry:200,fill:"#555555"}},{key:"triangle",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M22.2692 6.98965C23.0395 5.65908 24.9565 5.65908 25.7309 6.98965L44.262 38.9979C45.0339 40.3313 44.0718 42 42.5311 42H5.4689C3.92823 42 2.96611 40.3313 3.73804 38.9979L22.2692 6.98965Z" fill="#555" stroke="#555" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>',shape:es.fabric.Triangle,options:{width:200,height:180,fill:"#555555"}},{key:"right-angle",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 9.1153C8 7.29468 10.2347 6.42094 11.4696 7.75874L40.9016 39.6434C42.0842 40.9246 41.1755 43 39.432 43H10C8.89543 43 8 42.1046 8 41V9.1153Z" fill="#555" stroke="#555" stroke-width="4" stroke-linecap="square" stroke-linejoin="miter"/></svg>',shape:es.fabric.Polygon,options:{points:[{x:0,y:0},{x:0,y:200},{x:200,y:200}],fill:"#555555"}},{key:"diamond",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.41421 22.5858L22.5858 5.41421C23.3668 4.63317 24.6332 4.63316 25.4142 5.41421L42.5858 22.5858C43.3668 23.3668 43.3668 24.6332 42.5858 25.4142L25.4142 42.5858C24.6332 43.3668 23.3668 43.3668 22.5858 42.5858L5.41421 25.4142C4.63317 24.6332 4.63316 23.3668 5.41421 22.5858Z" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:es.fabric.Polygon,options:{points:[{x:0,y:100},{x:100,y:200},{x:200,y:100},{x:100,y:0}],fill:"#555555"}},{key:"parallelgram",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M41.2796 8H15.4704C14.5956 8 13.8223 8.5685 13.5614 9.40345L4.81142 37.4035C4.40897 38.6913 5.3711 40 6.72038 40H32.5296C33.4044 40 34.1777 39.4315 34.4386 38.5965L43.1886 10.5965C43.591 9.30869 42.6289 8 41.2796 8Z" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:es.fabric.Polygon,options:{points:[{x:50,y:0},{x:0,y:100},{x:200,y:100},{x:250,y:0}],fill:"#555555"}},{key:"pentagon",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M25.2296 4.95843L42.8601 18.7012C43.5405 19.2316 43.8041 20.1385 43.5141 20.951L36.4739 40.6724C36.1897 41.4685 35.4357 42 34.5903 42H13.4097C12.5643 42 11.8103 41.4685 11.5261 40.6724L4.48593 20.951C4.19588 20.1385 4.45953 19.2315 5.13995 18.7012L22.7704 4.95843C23.4933 4.39496 24.5067 4.39496 25.2296 4.95843Z" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:es.fabric.Polygon,options:{points:ts(5),fill:"#555555"}},{key:"hexagon",elem:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M23.0287 43.4604L7.02871 34.5715C6.39378 34.2188 6 33.5495 6 32.8232V15.1768C6 14.4505 6.39378 13.7812 7.02872 13.4285L23.0287 4.5396C23.6328 4.20402 24.3672 4.20402 24.9713 4.5396L40.9713 13.4285C41.6062 13.7812 42 14.4505 42 15.1768V32.8232C42 33.5495 41.6062 34.2188 40.9713 34.5715L24.9713 43.4604C24.3672 43.796 23.6328 43.796 23.0287 43.4604Z" fill="#555" stroke="#555" stroke-width="4"/></svg>',shape:es.fabric.Polygon,options:{points:ts(6),fill:"#555555"}},{key:"star",elem:'<svg width="200" height="200" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M23.9986 5L17.8856 17.4776L4 19.4911L14.0589 29.3251L11.6544 43L23.9986 36.4192L36.3454 43L33.9586 29.3251L44 19.4911L30.1913 17.4776L23.9986 5Z" fill="#ffffff" stroke="#555555" stroke-width="4" stroke-linejoin="round"/></svg>'},{key:"heart",elem:'<svg width="200" height="200" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 8C8.92487 8 4 12.9249 4 19C4 30 17 40 24 42.3262C31 40 44 30 44 19C44 12.9249 39.0751 8 33 8C29.2797 8 25.9907 9.8469 24 12.6738C22.0093 9.8469 18.7203 8 15 8Z" fill="#ffffff" stroke="#555555" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>'}],tu=n.p+"assets/rect.df3b593f.png",th=n.p+"assets/circle.c2faca88.png",tf=n.p+"assets/ellipse.41feedb4.png",td=n.p+"assets/right-angle.93573792.png",tp=n.p+"assets/diamond.d2acbdbe.png",tv={hachureGap:16,fillWeight:4,strokeWidth:8,roughness:1.6,bowing:1},tg=[{key:"rough-line",elem:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATYAAAAMCAYAAADoKpHWAAAAAXNSR0IArs4c6QAAAjFJREFUaEPtm7Fu01AYhc+5TqiUIFVi6FCJ4jwDCyuPACKoS5Z2YYCNGTHBIyBZQBELggoJlRdgRuwsSHUFgg4MIJRCk/gepkooTS2HOr1x/GeMr3P+892bc23rNzHh82Xj5lUQa5OOHX0nISaxnDdmlsckdYBw+rP0lssdTB3xI5T+JN0M2ovAoDXJKx018DMEl2Vi90KyHUQ7hN8qaHK8yG+31uPhwD8EdCXPAIG2gGZAk22G1Q9lvS9gGEp8ki6B8DUJfUcMAnEJ7z+Q8XmQJbHVirDz7+ZyLNg+b3ZvU7gr4NI8FG01GAEjYATy72J0r9FoPlpNXnw/Gnc82Da6zwWs1/RqyFaQETACFSMgFAm2ze5rCNcr5s3KNQJGoKYELNhqOvFm2wgsMgELtkWeXfNmBGpKQOAWqQcXn2x/OvkZm92K1nR5mG0jUE0Cgl55F92PH7/8aMFWzTm0qo2AERgjUOlgE5ByFo2pYkqFaeys6woVFeOMm7sldFjDhu6FXmPCOzo+y0bZh+bSYHc1eXuQ0+5x4w7lLhcBIvqUbroueC+Xuv8IElF9uvIbMA8P3UHLMVRjZxHMizemyXaG0Zk2d2cZzkdg6Zp0PlaJgSmPDuVKeaOnjA1knjeESVdqJwbbfu/aiqKlVqF/E7P+Hw2n6oKPz630mSRTnVOoFhtkBAIQ2O/12r+jX6UFZsM32w0XlfN7JWwgp90QThv8eUHvnX8PDd6sPd35Oj71fwE3zdMN1O33QQAAAABJRU5ErkJggg==",options:(0,I._)({stroke:"#E36255"},tv)},{key:"rough-rect",elem:tu,options:(0,I._)({fill:"#F6C445",stroke:"#EC6A52"},tv)},{key:"rough-circle",elem:th,options:(0,I._)({fill:"#F6C445",stroke:"#EC6A52"},tv)},{key:"rough-ellipse",elem:tf,options:(0,I._)({fill:"#F6C445",stroke:"#EC6A52"},tv)},{key:"rough-right-angle",elem:td,options:(0,I._)({fill:"#F6C445",stroke:"#EC6A52"},tv)},{key:"rough-diamond",elem:tp,options:(0,I._)({fill:"#F6C445",stroke:"#EC6A52"},tv)}],tm=function(e){var t=e.points,n=e.canvas,r=(0,V._)(e,["points","canvas"]),i=new es.fabric.FLine(t||[0,0,300,0],(0,I._)({strokeWidth:4,stroke:"#000000",strokeLineJoin:"round",strokeLineCap:"round",borderColor:"#00000000",id:ey()},r));return n.viewportCenterObject(i),i.set({x1:i.left,y1:i.top,x2:i.left+300,y2:i.top}),n.add(i),n.setActiveObject(i),n.requestRenderAll(),i},tb=function(e){var t=e.points,n=e.canvas,r=(0,V._)(e,["points","canvas"]),i=new es.fabric.FArrow(t||[0,0,300,0],(0,I._)({strokeWidth:4,stroke:"#000000",fill:"#000000",strokeLineJoin:"round",strokeLineCap:"round",borderColor:"#00000000"},r));return n.viewportCenterObject(i),i.set({x1:i.left,y1:i.top,x2:i.left+300,y2:i.top}),n.add(i),n.setActiveObject(i),n.requestRenderAll(),i},ty=function(e){var t=e.points,n=e.canvas,r=(0,V._)(e,["points","canvas"]),i=new es.fabric.FTriArrow(t||[0,0,300,0],(0,I._)({strokeWidth:4,stroke:"#000000",fill:"#000000",strokeLineJoin:"round",strokeLineCap:"round",borderColor:"#00000000"},r));return n.viewportCenterObject(i),i.set({x1:i.left,y1:i.top,x2:i.left+300,y2:i.top}),n.add(i),n.setActiveObject(i),n.requestRenderAll(),i},tk=(f=(0,k._)(function(e){return(0,Z.Jh)(this,function(t){return[2,new Promise(function(t){es.fabric.loadSVGFromString(e,function(e,n){t(es.fabric.util.groupSVGElements(e,n))})})]})}),function(e){return f.apply(this,arguments)});(0,k._)(function(e){return(0,Z.Jh)(this,function(t){return[2,new Promise(function(t){es.fabric.loadSVGFromURL(e,function(e,n){t(es.fabric.util.groupSVGElements(e,n))})})]})});var tw=(d=(0,k._)(function(e){var t,n,r,i,o;return(0,Z.Jh)(this,function(a){switch(a.label){case 0:return n=(t=e||{}).svgString,r=t.canvas,i=(0,V._)(t,["svgString","canvas"]),[4,tk(n)];case 1:return(o=a.sent()).set((0,J._)((0,I._)({},i),{id:ey()})),r.viewportCenterObject(o),r.add(o),r.setActiveObject(o),r.requestRenderAll(),[2,o]}})}),function(e){return d.apply(this,arguments)});function tZ(){var e=(0,x.useContext)(j),t=e.editor,n=e.roughSvg,r=(0,Q.$G)().t,i=function(e){var n=e.type,r=e.options,i=void 0===r?{}:r,o=t.canvas;switch(n){case"f-line":tm((0,J._)((0,I._)({},i),{canvas:o}));break;case"f-arrow":tb((0,J._)((0,I._)({},i),{canvas:o}));break;case"f-tri-arrow":ty((0,J._)((0,I._)({},i),{canvas:o}))}},o=function(e){var n,r,i,o,a,l,s,c,u,h,f=e.key,d=e.elem,p=e.options,v=t.canvas;switch(f){case"rect":case"rect-r":r=(n=(0,J._)((0,I._)({},p),{canvas:v})||{}).canvas,i=(0,V._)(n,["canvas"]),o=new es.fabric.Rect((0,I._)({id:ey(),width:200,height:200},i)),r.viewportCenterObject(o),r.add(o),r.setActiveObject(o),r.requestRenderAll();break;case"star":case"heart":tw({svgString:d,canvas:v,sub_type:f,strokeWidth:20});break;default:a=e.shape,c=(s=(0,J._)((0,I._)({},p),{canvas:v})||{}).points,u=s.canvas,h=(0,V._)(s,["points","canvas"]),l=a===es.fabric.Polygon?new es.fabric.Polygon(c,(0,I._)({id:ey()},h)):new a((0,I._)({id:ey()},h)),u.viewportCenterObject(l),u.add(l),u.setActiveObject(l),u.requestRenderAll()}},a=function(e){var r,i=e.key,o=e.options,a=t.canvas;switch(i){case"rough-line":r=n.line(0,0,300,0,o);break;case"rough-rect":r=n.rectangle(0,0,400,400,o);break;case"rough-circle":r=n.circle(0,0,300,o);break;case"rough-ellipse":r=n.ellipse(0,0,300,150,o);break;case"rough-right-angle":r=n.polygon([[0,0],[0,300],[300,300]],o);break;case"rough-diamond":r=n.polygon([[0,150],[150,300],[300,150],[150,0]],o)}console.log(r),tw({svgString:'<svg fill="none" xmlns="http://www.w3.org/2000/svg">'.concat(r.innerHTML,"</svg>"),canvas:a,sub_type:"rough"})};return(0,b.BX)("div",{className:"fabritor-panel-wrapper",children:[(0,b.tZ)(eG,{children:r("panel.material.line")}),(0,b.tZ)(U.Z,{gap:10,wrap:"wrap",justify:"space-around",children:ta.map(function(e){return(0,b.tZ)("div",{onClick:function(){i(e)},className:"fabritor-panel-shape-item",children:(0,b.tZ)("img",{src:"data:image/svg+xml,".concat(encodeURIComponent(e.svg)),alt:"",style:{width:48,height:48}})},e.key)})}),(0,b.tZ)(eG,{children:r("panel.material.shape")}),(0,b.tZ)(U.Z,{gap:10,wrap:"wrap",justify:"space-around",children:tc.map(function(e){return(0,b.tZ)("div",{onClick:function(){o(e)},className:"fabritor-panel-shape-item",children:(0,b.tZ)("img",{src:"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(e.elem)),style:{width:64,height:64}})},e.key)})}),(0,b.tZ)(eG,{children:(0,b.BX)("div",{style:{position:"relative"},children:[(0,b.tZ)("span",{children:r("panel.material.hand_drawn")}),(0,b.tZ)(to.Z,{color:"#f50",style:{position:"absolute",right:-48,top:-5,padding:"0 4px"},children:"beta"})]})}),(0,b.tZ)(U.Z,{gap:10,wrap:"wrap",justify:"space-around",children:tg.map(function(e){return(0,b.tZ)("div",{onClick:function(){a(e)},className:"fabritor-panel-shape-item",children:(0,b.tZ)(Y,{style:{width:64,height:64},children:(0,b.tZ)("img",{src:e.elem,style:{width:64}})})},e.key)})})]})}var tx=[{key:"p-1",svg:'<svg t="1701335273782" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="44143" width="32" height="32"><path d="M910.607 339.457c31.267-31.267 31.267-81.96 0-113.227l-113.21-113.193c-31.266-31.267-81.959-31.267-113.208 0l-28.315 28.298 226.436 226.42 28.297-28.298z m6.696 561.183H349.441L854.01 396.054l-226.434-226.42L89.81 707.4l0.231 0.231h-0.099v208.261c-0.051 0.537-0.082 1.082-0.082 1.634s0.031 1.096 0.082 1.635v14.491h11.778c1.587 0.494 3.275 0.76 5.026 0.76h810.557c9.317 0 16.887-7.552 16.887-16.886-0.001-9.335-7.57-16.886-16.887-16.886z" fill="#1296db" p-id="44144"></path></svg>',title:(0,b.tZ)(Q.cC,{i18nKey:"panel.paint.pencil"}),options:{color:"#1296db",width:4,strokeLineCap:"round"}},{key:"p-2",svg:'<svg t="1701335152027" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="39748" width="32" height="32"><path d="M1002.644 893.774H142.004c-11.782 0-21.312 9.562-21.312 21.344v42.656c0 11.782 9.532 21.344 21.312 21.344h860.64c11.782 0 21.342-9.562 21.342-21.344v-42.656c0-11.782-9.56-21.344-21.342-21.344z" fill="#FF0000" p-id="39749"></path><path d="M368.282 731.496l-90.5-90.496c-8.344-8.344-21.842-8.344-30.156 0L6.256 882.34a21.42 21.42 0 0 0-5.968 18.528 21.298 21.298 0 0 0 11.532 15.656l120.654 60.344a21.552 21.552 0 0 0 9.532 2.25c5.532 0 11-2.156 15.094-6.25l211.184-211.184c4-4 6.25-9.438 6.25-15.094s-2.252-11.094-6.252-15.094z" fill="#FF0000" p-id="39750"></path><path d="M459.874 702.434l-150.84-150.84c-8.312-8.344-21.844-8.344-30.156 0l-181.028 180.996c-4 4-6.25 9.438-6.25 15.094s2.25 11.094 6.25 15.094l150.84 150.84a21.356 21.356 0 0 0 30.186 0l180.998-181.028c4-4 6.25-9.438 6.25-15.094s-2.25-11.062-6.25-15.062z" fill="#FF0000" p-id="39751"></path><path d="M947.866 184.288l-120.688-120.684c-12.094-12.062-28.156-18.718-45.25-18.718s-33.154 6.656-45.248 18.718L173.286 627a21.332 21.332 0 0 0 0 30.188l180.996 180.996c4 4 9.438 6.25 15.094 6.25s11.094-2.25 15.094-6.25l563.396-563.398c12.092-12.062 18.748-28.156 18.748-45.248 0-17.094-6.656-33.158-18.748-45.25z" fill="#FF0000" p-id="39752"></path><path d="M947.866 274.786c12.092-12.062 18.748-28.156 18.748-45.248 0-17.094-6.656-33.156-18.748-45.25l-120.688-120.684 90.5 90.53c12.094 12.062 18.75 28.156 18.75 45.25s-6.656 33.156-18.75 45.25L354.282 808.028c-4 4-9.406 6.25-15.062 6.25a21.36 21.36 0 0 1-15.094-6.25l30.156 30.156c4 4 9.438 6.25 15.094 6.25s11.094-2.25 15.094-6.25l563.396-563.398z" fill="#FF0000" opacity=".2" p-id="39753"></path></svg>',title:(0,b.tZ)(Q.cC,{i18nKey:"panel.paint.marker_pen"}),options:{color:"#FF0000",width:36,strokeLineCap:"square"}}],tC=n(1524),t_=n(746),tS=n(4125);function tj(e){var t=e.value,n=e.onChange,r=e.trigger;return(0,b.tZ)(e9.Z,{content:(0,b.tZ)(tS.Z,{value:t,onChange:function(e){null==n||n(e)},format:"hex"}),children:(0,b.tZ)("div",{className:"fabritor-toolbar-item",style:{borderRadius:4,backgroundColor:"#ffffff"===new t_.Il(t).toHexString()?"rgba(103,103,103,0.24)":null},children:r||(0,b.tZ)("svg",{width:22,height:22,viewBox:"64 64 896 896",focusable:"false",fill:t,"aria-hidden":"true",children:(0,b.tZ)("path",{d:"M766.4 744.3c43.7 0 79.4-36.2 79.4-80.5 0-53.5-79.4-140.8-79.4-140.8S687 610.3 687 663.8c0 44.3 35.7 80.5 79.4 80.5zm-377.1-44.1c7.1 7.1 18.6 7.1 25.6 0l256.1-256c7.1-7.1 7.1-18.6 0-25.6l-256-256c-.6-.6-1.3-1.2-2-1.7l-78.2-78.2a9.11 9.11 0 00-12.8 0l-48 48a9.11 9.11 0 000 12.8l67.2 67.2-207.8 207.9c-7.1 7.1-7.1 18.6 0 25.6l255.9 256zm12.9-448.6l178.9 178.9H223.4l178.8-178.9zM904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8z"})})})})}var tA=n(5893),tO=n(4869);function tz(e){var t,n=e.defaultColor,r=void 0===n?"#ffffff":n,i=e.trigger,o=e.type,a=e.value,l=e.onChange,s=function(){switch(null==a?void 0:a.type){case"solid":return a.color;case"linear":case"radial":return"url(#colorsetter-icon-gradient) ".concat(a.color||"rgba(0, 0, 0, 0.88)");default:return"rgba(0, 0, 0, 0.88)"}};return(0,b.BX)(tA.Fragment,{children:[(0,b.tZ)(e9.Z,{content:(0,b.tZ)("div",{className:"fabritor-color-setter",children:(0,b.tZ)(tO.Z,{value:a,onChange:function(e){e&&(e.color||(e.color=r),null==l||l(e))},format:"hex",angleType:"rotate"})}),trigger:"click",children:(0,b.tZ)("div",{className:"fabritor-toolbar-item",style:{borderRadius:4,backgroundColor:(null==a?void 0:a.type)==="solid"&&"#ffffff"===new t_.Il(a.color).toHexString()?"rgba(103,103,103,0.24)":null},children:i||("fontColor"===o?(0,b.tZ)("svg",{viewBox:"64 64 896 896",focusable:"false",width:22,height:22,fill:s(),"aria-hidden":"true",children:(0,b.tZ)("path",{d:"M904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8zm-650.3-80h85c4.2 0 8-2.7 9.3-6.8l53.7-166h219.2l53.2 166c1.3 4 5 6.8 9.3 6.8h89.1c1.1 0 2.2-.2 3.2-.5a9.7 9.7 0 006-12.4L573.6 118.6a9.9 9.9 0 00-9.2-6.6H462.1c-4.2 0-7.9 2.6-9.2 6.6L244.5 723.1c-.4 1-.5 2.1-.5 3.2-.1 5.3 4.3 9.7 9.7 9.7zm255.9-516.1h4.1l83.8 263.8H424.9l84.7-263.8z"})}):(0,b.tZ)("svg",{width:22,height:22,viewBox:"64 64 896 896",focusable:"false",fill:s(),"aria-hidden":"true",children:(0,b.tZ)("path",{d:"M766.4 744.3c43.7 0 79.4-36.2 79.4-80.5 0-53.5-79.4-140.8-79.4-140.8S687 610.3 687 663.8c0 44.3 35.7 80.5 79.4 80.5zm-377.1-44.1c7.1 7.1 18.6 7.1 25.6 0l256.1-256c7.1-7.1 7.1-18.6 0-25.6l-256-256c-.6-.6-1.3-1.2-2-1.7l-78.2-78.2a9.11 9.11 0 00-12.8 0l-48 48a9.11 9.11 0 000 12.8l67.2 67.2-207.8 207.9c-7.1 7.1-7.1 18.6 0 25.6l255.9 256zm12.9-448.6l178.9 178.9H223.4l178.8-178.9zM904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8z"})}))})}),(0,b.tZ)("svg",{style:{width:0,height:0,position:"absolute"},"aria-hidden":"true",focusable:"false",children:(0,b.tZ)("linearGradient",{id:"colorsetter-icon-gradient",x2:"1",y2:"1",children:null==a?void 0:null===(t=a.gradient)||void 0===t?void 0:t.colorStops.map(function(e){return(0,b.tZ)("stop",{offset:"".concat(100*e.offset,"%"),"stop-color":e.color})})})})]})}var tF=n(991),tR=n(4163);function tB(e){var t=e.min,n=void 0===t?1:t,r=e.max,i=void 0===r?100:r,o=e.step,a=void 0===o?1:o,l=e.style,s=e.sliderProps,c=e.inputProps,u=e.onChange,h=e.onChangeComplete,f=e.value;return(0,b.BX)(U.Z,{gap:6,style:l,children:[(0,b.tZ)(tF.Z,(0,I._)({style:{flex:1},min:n,max:i,step:a,onChange:u,onAfterChange:h,value:f},s)),(0,b.tZ)(tR.Z,(0,I._)({min:n,max:i,step:a,onChange:u,value:f,style:{width:56},controls:!1},c))]})}var tP=tC.Z.Item;function tL(e){var t=e.value,n=e.onChange,r=e.shouldFireEvent,i=e.showPenTip,o=e.showFillConfig,a=(0,w._)(tC.Z.useForm(),1)[0],l=(0,x.useContext)(j).editor,s=(0,Q.$G)().t,c=function(){r&&l.fireCustomModifiedEvent()};return(0,x.useEffect)(function(){a.setFieldsValue(t)},[t]),(0,b.BX)(tC.Z,{form:a,onValuesChange:n,style:{marginBottom:0,marginTop:16},colon:!1,children:[i?(0,b.tZ)(tP,{label:(0,b.tZ)("span",{style:{fontSize:15,fontWeight:"bold"},children:s("panel.paint.title")})}):null,(0,b.tZ)(tP,{label:s(o?"common.stroke":"common.stroke_color"),name:"color",children:(0,b.tZ)(tj,{onChange:c})}),(0,b.tZ)(tP,{label:s("common.line_width"),name:"width",children:(0,b.tZ)(tB,{min:1,max:100,onChangeComplete:c})}),o?(0,b.tZ)(tP,{label:s("common.fill"),name:"fill",children:(0,b.tZ)(tz,{onChange:c})}):null,(0,b.tZ)(tP,{label:(0,b.tZ)("span",{style:{fontSize:15,fontWeight:"bold"},children:s("common.shadow")})}),(0,b.tZ)(tP,{label:s("common.color"),name:["shadow","color"],children:(0,b.tZ)(tj,{onChange:c})}),(0,b.tZ)(tP,{label:s("common.width"),name:["shadow","width"],children:(0,b.tZ)(tB,{min:0,max:50,onChangeComplete:c})}),(0,b.tZ)(tP,{label:s("common.offset"),name:["shadow","offset"],children:(0,b.tZ)(tB,{min:0,max:20,onChangeComplete:c})})]})}function tX(){var e=(0,w._)((0,x.useState)(0),2),t=e[0],n=e[1],r=(0,w._)((0,x.useState)(!0),2),i=r[0],o=r[1],a=(0,x.useContext)(j).editor,l=(0,w._)((0,x.useState)({}),2),s=l[0],c=l[1],u=(0,Q.$G)().t,h=function(e){if(e.color&&(a.canvas.freeDrawingBrush.color=e.color),e.width&&(a.canvas.freeDrawingBrush.width=e.width),e.strokeLineCap&&(a.canvas.freeDrawingBrush.strokeLineCap=e.strokeLineCap),e.shadow){var t=a.canvas.freeDrawingBrush.shadow,n=t?t.toObject():{},r={blur:e.shadow.width||n.blur,offsetX:e.shadow.offset||n.offsetX,offsetY:e.shadow.offset||n.offsetY,affectStroke:!0,color:e.shadow.color||n.color};a.canvas.freeDrawingBrush.shadow=new es.fabric.Shadow(r)}},f=function(){if(a){a.canvas.isDrawingMode=!0,a.canvas.freeDrawingCursor='url("data:image/svg+xml;charset=utf-8,'.concat(encodeURIComponent('<svg t="1701336130548" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="46063" width="16" height="16"><path d="M666.112 549.568l116.032-116.8-241.856-244.16-115.2 116.928-104.64 105.152-94.912 94.784A5667.84 5667.84 0 0 0 154.88 577.536c-19.456 19.456-30.784 31.744-36.48 36.992-10.304 10.048-19.584 21.12-27.52 32.96a198.272 198.272 0 0 0-17.088 33.088 208.64 208.64 0 0 0-17.088 42.88c-7.296 20.8-13.824 43.52-21.12 68.16-7.296 24.704-14.592 48.64-21.12 71.424a411.968 411.968 0 0 0-12.16 52.48 61.184 61.184 0 0 0 6.528 48.064 50.56 50.56 0 0 0 46.272 10.368c11.264-1.792 28.352-5.696 51.136-11.648a1664.32 1664.32 0 0 0 145.28-46.784c18.112-6.272 35.584-13.632 52.8-22.016 12.544-5.248 24.32-12.288 34.944-20.8 11.328-8.704 21.12-16.896 30.08-24.32a520.96 520.96 0 0 0 32.384-31.168l68.16-69.44c27.52-28.16 58.432-59.136 93.248-92.8l103.04-105.408z m232.064-232.384c5.632-6.08 12.928-12.992 21.12-20.8 8.128-7.808 17.856-16.896 27.52-27.328 8.96-9.472 16-20.48 21.12-32.448 4.16-10.752 6.336-22.208 6.528-33.728a202.24 202.24 0 0 0-3.2-32.448 119.872 119.872 0 0 0-8.96-27.328 272.512 272.512 0 0 0-50.304-74.56 255.04 255.04 0 0 0-60.096-49.92 205.952 205.952 0 0 0-30.784-11.648 141.568 141.568 0 0 0-35.712-5.888 112.768 112.768 0 0 0-38.08 5.248 115.52 115.52 0 0 0-38.08 20.096c-8.96 8.192-21.12 18.432-34.944 31.808-13.824 13.376-26.816 24.832-37.376 34.304l241.92 242.816c5.632-5.12 12.032-11.2 19.328-18.176z" fill="#2c2c2c" p-id="46064"></path></svg>'),'") 4 12, crosshair');var e=new es.fabric.PencilBrush(a.canvas);a.canvas.freeDrawingBrush=e;var t=tx[0].options,n=t.color,r=t.width;e.color=n,e.width=r,e.shadow=new es.fabric.Shadow({blur:0,offsetX:0,offsetY:0,affectStroke:!0,color:"#000000"}),c({color:n,width:r,shadow:{color:"#000000",width:0,offset:0}})}return function(){(null==a?void 0:a.canvas)&&(a.canvas.isDrawingMode=!1)}};return(0,x.useEffect)(function(){return f()},[]),(0,b.BX)("div",{className:"fabritor-panel-wrapper",children:[(0,b.tZ)(U.Z,{wrap:"wrap",justify:"space-around",children:tx.map(function(e,r){return(0,b.tZ)(N.Z,{trigger:"hover",title:e.title,children:(0,b.tZ)("div",{className:"fabritor-panel-shape-item",onClick:function(){h(e.options),n(r),c((0,I._)({},s,e.options))},style:{padding:"4px 8px",backgroundColor:t===r?"#eeeeee":"rgba(0,0,0,0)",borderRadius:8},children:(0,b.tZ)("img",{src:"data:image/svg+xml,".concat(encodeURIComponent(e.svg)),alt:"",style:{width:56,height:56}})},e.key)})})}),(0,b.tZ)(tL,{onChange:h,value:s,showPenTip:!0}),(0,b.tZ)(eG,{children:u("common.operate")}),(0,b.tZ)(U.Z,{wrap:"wrap",justify:"space-around",children:(0,b.tZ)(ei.ZP,{style:{width:64},onClick:function(){a.canvas.isDrawingMode=!a.canvas.isDrawingMode,o(!i)},type:i?"default":"primary",title:u(i?"panel.paint.stop":"panel.paint.start"),children:(0,b.tZ)("img",{src:"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(L)),style:{width:22,height:22}})})})]})}var tM=n(8202),tE=n(8538),tH=n(4916),tW=n(3453),tT=es.fabric.controlsUtils,tI=function(){var e=es.fabric.Object.prototype.controls;if(es.fabric.Rect){var t=es.fabric.Rect.prototype.controls={};t.tr=e.tr,t.br=e.br,t.tl=e.tl,t.bl=e.bl,t.mt=e.mt,t.mb=e.mb,t.mtr=e.mtr,t.copy=e.copy,t.del=e.del,t.ml=new es.fabric.Control({x:-.5,y:0,actionHandler:tT.changeWidth,cursorStyleHandler:e.ml.cursorStyleHandler,actionName:"resizing",render:e.ml.render}),t.mr=new es.fabric.Control({x:.5,y:0,actionHandler:tT.changeWidth,cursorStyleHandler:e.mr.cursorStyleHandler,actionName:"resizing",render:e.mr.render}),t.mt=new es.fabric.Control({x:0,y:-.5,offsetY:-1,actionHandler:nh,cursorStyleHandler:e.mt.cursorStyleHandler,actionName:"resizing",render:e.mt.render}),t.mb=new es.fabric.Control({x:0,y:.5,offsetY:1,actionHandler:nh,cursorStyleHandler:e.mb.cursorStyleHandler,actionName:"resizing",render:e.mb.render})}},tJ=function(e,t,n,r){return t.target.set({x2:n,y2:r}),!0},tV=function(e,t,n,r){return t.target.set({x1:n,y1:r}),!0},tU=function(e,t){return function(n,r,i){if(null==i||!i.canvas)return new es.fabric.Point(0,0);var o=i.calcLinePoints(),a=new es.fabric.Point(o[e],o[t]);return es.fabric.util.transformPoint(a,es.fabric.util.multiplyTransformMatrices(i.canvas.viewportTransform,i.calcTransformMatrix()))}},tY=function(){var e=es.fabric.Object.prototype.controls;if(es.fabric.Line){var t=es.fabric.Line.prototype.controls={};t.copy=e.copy,t.del=e.del,t.l1=new es.fabric.Control({positionHandler:tU("x1","y1"),actionHandler:tV,cursorStyleHandler:function(){return"crosshair"},actionName:"line-points-change",render:e.br.render}),t.l2=new es.fabric.Control({positionHandler:tU("x2","y2"),actionHandler:tJ,cursorStyleHandler:function(){return"crosshair"},actionName:"line-points-change",render:e.br.render})}},tD=es.fabric.controlsUtils,tN=function(){var e=es.fabric.Object.prototype.controls;if(es.fabric.Rect){var t=es.fabric.FText.prototype.controls={};t.tr=e.tr,t.br=e.br,t.tl=e.tl,t.bl=e.bl,t.mtr=e.mtr,t.copy=e.copy,t.del=e.del,t.ml=new es.fabric.Control({x:-.5,y:0,offsetX:-1,actionHandler:tD.changeWidth,cursorStyleHandler:e.ml.cursorStyleHandler,actionName:"resizing",render:e.ml.render}),t.mr=new es.fabric.Control({x:.5,y:0,offsetX:1,actionHandler:tD.changeWidth,cursorStyleHandler:e.mr.cursorStyleHandler,actionName:"resizing",render:e.mr.render})}},tG=document.createElement("img");tG.src=A;var tq=document.createElement("img");tq.src=O;var tK=document.createElement("img");tK.src=F;var t$=document.createElement("img");t$.src=R;var tQ=document.createElement("img");tQ.src=B;var t0=document.createElement("img");t0.src=P;var t1=function(e,t,n,r,i,o){var a="TB"===o?20:6,l="TB"===o?6:20;e.save(),e.fillStyle="#ffffff",e.strokeStyle="#bbbbbb",e.lineWidth=2,e.shadowBlur=2,e.shadowColor="#dddddd",e.translate(t,n),e.rotate(es.fabric.util.degreesToRadians(i.angle)),e.beginPath(),e.roundRect(-a/2,-l/2,a,l,10),e.stroke(),e.fill(),e.restore()},t2=function(e,t,n,r,i){t1(e,t,n,r,i,"LR")},t3=function(e,t,n,r,i){t1(e,t,n,r,i,"TB")},t6=function(e,t,n,r,i){e.save(),e.fillStyle="#ffffff",e.strokeStyle="#bbbbbb",e.lineWidth=2,e.shadowBlur=2,e.shadowColor="#dddddd",e.beginPath(),e.arc(t,n,6,0,2*Math.PI,!1),e.stroke(),e.fill(),e.restore()};function t4(e){return function(t,n,r,i,o){t.save(),t.translate(n,r),t.rotate(es.fabric.util.degreesToRadians(o.angle)),t.drawImage(e,-14,-14,28,28),t.restore()}}var t8=(p=(0,k._)(function(e,t){var n,r;return(0,Z.Jh)(this,function(e){switch(e.label){case 0:return[4,ni(r=(n=t.target).canvas,n)];case 1:return e.sent(),no(r),[2,!0]}})}),function(e,t){return p.apply(this,arguments)}),t5=function(e,t){var n=t.target,r=n.canvas;return na(n,r),!0},t7=function(){var e={x:0,y:-.5,offsetY:-1,render:t3};Object.keys(e).forEach(function(t){es.fabric.Object.prototype.controls.mt[t]=e[t]});var t={x:0,y:.5,offsetY:1,render:t3};Object.keys(t).forEach(function(e){es.fabric.Object.prototype.controls.mb[e]=t[e]});var n={x:-.5,y:0,offsetX:-1,render:t2};Object.keys(n).forEach(function(e){es.fabric.Object.prototype.controls.ml[e]=n[e]});var r={x:.5,y:0,offsetX:1,render:t2};Object.keys(r).forEach(function(e){es.fabric.Object.prototype.controls.mr[e]=r[e]});var i={x:-.5,y:-.5,render:t6};Object.keys(i).forEach(function(e){es.fabric.Object.prototype.controls.tl[e]=i[e]});var o={x:.5,y:-.5,render:t6};Object.keys(o).forEach(function(e){es.fabric.Object.prototype.controls.tr[e]=o[e]});var a={x:-.5,y:.5,render:t6};Object.keys(a).forEach(function(e){es.fabric.Object.prototype.controls.bl[e]=a[e]});var l={x:.5,y:.5,render:t6};Object.keys(l).forEach(function(e){es.fabric.Object.prototype.controls.br[e]=l[e]})},t9=function(){var e={x:0,y:.5,offsetY:38,cursorStyleHandler:function(){return'url("data:image/svg+xml;charset=utf-8,'.concat(z,'") 12 12, crosshair')},render:t4(tG),withConnection:!1};Object.keys(e).forEach(function(t){es.fabric.Object.prototype.controls.mtr[t]=e[t]})},ne=function(){var e=new es.fabric.Control({x:0,y:-.5,offsetX:-24,offsetY:-26,cursorStyle:"pointer",mouseUpHandler:t8,render:t4(tK)});es.fabric.Object.prototype.controls.copy=e;var t=new es.fabric.Control({x:0,y:-.5,offsetX:24,offsetY:-26,cursorStyle:"pointer",mouseUpHandler:t5,render:t4(tQ)});es.fabric.Object.prototype.controls.del=t},nt=function(e,t){"mtr"===e&&(t.controls[e].render=t4(tq)),"copy"===e&&(t.controls[e].render=t4(t$)),"del"===e&&(t.controls[e].render=t4(t0)),t.canvas.requestRenderAll()},nn=function(e){var t,n,r;e&&((null===(t=e.controls)||void 0===t?void 0:t.mtr)&&(e.controls.mtr.render=t4(tG)),(null===(n=e.controls)||void 0===n?void 0:n.copy)&&(e.controls.copy.render=t4(tK)),(null===(r=e.controls)||void 0===r?void 0:r.del)&&(e.controls.del.render=t4(tQ)))},nr=es.fabric.controlsUtils,ni=(v=(0,k._)(function(e,t){return(0,Z.Jh)(this,function(n){return[2,new Promise(function(n){return(t||(t=e.getActiveObject()),t)?(navigator.clipboard.writeText(""),t.clone(function(e){return m=e,n(!0)},em)):Promise.resolve(!1)})]})}),function(e,t){return v.apply(this,arguments)}),no=(g=(0,k._)(function(e){var t,n,r;return(0,Z.Jh)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,eS()];case 1:if(n=(t=i.sent()||{}).type,r=t.result)return"text"===n?e2({text:r,canvas:e}):"image"===n&&e5({imageSource:r,canvas:e}),[2];return[3,3];case 2:return console.error("Failed to read clipboard contents: ",i.sent()),[3,3];case 3:return m.clone(function(t){e.discardActiveObject(),t.set({left:t.left+50,top:t.top+50,evented:!0}),("f-line"===t.type||"f-arrow"===t.type||"f-tri-arrow"===t.type)&&nf({target:t,transform:{original:{left:t.left-50,top:t.top-50}}}),"activeSelection"===t.type?(t.canvas=e,t.forEachObject(function(t){e.add(t)}),t.setCoords()):e.add(t),e.setActiveObject(t),e.requestRenderAll(),e.fire("fabritor:clone",{target:t})},em),[2]}})}),function(e){return g.apply(this,arguments)}),na=function(e,t){if(e||(e=t.getActiveObject()),e)return"activeSelection"===e.type?(e.getObjects().forEach(function(e){t.remove(e)}),t.discardActiveObject()):t.remove(e),nn(e),t.requestRenderAll(),t.fire("fabritor:del",{target:null}),!0},nl=function(e,t){t||(t=e.getActiveObject()),t&&"activeSelection"===t.type&&(e.getActiveObjects().forEach(function(e){"f-image"===e.type&&(e.img.clipPath=null)}),t.toGroup(),e.requestRenderAll(),e.fire("fabritor:group"))},ns=function(e,t){t||(t=e.getActiveObject()),t&&"group"===t.type&&(t.getObjects().forEach(function(e){e.set({lockMovementX:!1,lockMovementY:!1,hasControls:!0,selectable:!0})}),t.toActiveSelection(),e.requestRenderAll(),e.fire("fabritor:ungroup"))},nc=function(e,t,n){if(n||(n=t.canvas.getActiveObject()),n&&"activeSelection"!==n.type){switch(e){case"layer-up":n.bringForward();break;case"layer-top":n.bringToFront();break;case"layer-down":n.sendBackwards();break;case"layer-bottom":n.sendToBack()}t.sketch.sendToBack(),t.canvas.requestRenderAll(),t.fireCustomModifiedEvent()}},nu=function(e,t,n,r,i){var o=e.target,a=o.controls[e.corner],l=o.canvas.getZoom(),s=o.padding/l,c=o.toLocalPoint(new es.fabric.Point(r,i),t,n);return c.x>=s&&(c.x-=s),c.x<=-s&&(c.x+=s),c.y>=s&&(c.y-=s),c.y<=s&&(c.y+=s),c.x-=a.offsetX,c.y-=a.offsetY,c},nh=nr.wrapWithFireEvent("resizing",nr.wrapWithFixedAnchor(function(e,t,n,r){var i=t.target,o=nu(t,t.originX,t.originY,n,r),a=i.strokeWidth/(i.strokeUniform?i.scaleX:1),l="center"===t.originX&&"center"===t.originY?2:1,s=i.height,c=Math.abs(o.y*l/i.scaleY)-a;return i.set("height",Math.max(c,0)),s!==c})),nf=function(e){var t=e.target,n=e.transform;if("line-points-change"!==e.action){var r=n.original,i=t.left-r.left,o=t.top-r.top;t.set({x1:t.x1+i,y1:t.y1+o,x2:t.x2+i,y2:t.y2+o})}},nd=function(e){var t=e.label,n=e.keyboard,r=e.cmdKey;(0,Q.$G)().t;var i=navigator.userAgent.indexOf("Mac OS X")>-1;return(0,b.BX)(U.Z,{gap:68,justify:"space-between",children:[(0,b.tZ)("span",{children:t}),(0,b.tZ)("span",{children:"".concat(void 0!==r&&r?i?"\u2318":"Ctrl":""," ").concat(n)})]})},np=(0,x.forwardRef)(function(e,t){var n,r=e.object,i=e.noCareOpen,o=(0,w._)((0,x.useState)(!1),2),a=o[0],l=o[1],s=(0,x.useContext)(j).editor,c=(0,Q.$G)().t,u=(n=(0,k._)(function(e){var t;return(0,Z.Jh)(this,function(n){switch(n.label){case 0:switch(t=e.key){case"copy":return[3,1];case"paste":return[3,3];case"copy&paste":return[3,4];case"del":return[3,7];case"group":return[3,8];case"ungroup":return[3,9];case"layer-up":case"layer-top":case"layer-down":case"layer-bottom":return[3,10]}return[3,11];case 1:case 4:return[4,ni(s.canvas,r)];case 2:case 6:return n.sent(),[3,12];case 3:return no(s.canvas),[3,12];case 5:return n.sent(),[4,no(s.canvas)];case 7:return na(r,s.canvas),[3,12];case 8:return nl(s.canvas,r),[3,12];case 9:return ns(s.canvas,r),[3,12];case 10:nc(t,s,r),n.label=11;case 11:return[3,12];case 12:return l(!1),[2]}})}),function(e){return n.apply(this,arguments)});return(0,x.useImperativeHandle)(t,function(){return{show:function(){return l(!0)},hide:function(){return l(!1)}}}),(0,b.tZ)(eo.Z,{menu:{items:function(){if(!r||r.id===eg)return[{label:(0,b.tZ)(nd,{label:c("setter.common.paste"),keyboard:"V",cmdKey:!0}),key:"paste"}];var e=[{label:(0,b.tZ)(nd,{label:c("setter.common.copy"),keyboard:"C",cmdKey:!0}),key:"copy"},{label:(0,b.tZ)(nd,{label:c("setter.common.paste"),keyboard:"V",cmdKey:!0}),key:"paste"},{label:(0,b.tZ)("span",{children:c("setter.common.create_a_copy")}),key:"copy&paste"},{label:(0,b.tZ)(nd,{label:c("setter.common.del"),keyboard:"DEL"}),key:"del"}];return"activeSelection"===r.type&&(e.push({type:"divider"}),e.push({label:c("setter.group.g"),key:"group"})),"group"!==r.type||r.sub_type||(e.push({type:"divider"}),e.push({label:c("setter.group.ung"),key:"ungroup"})),"activeSelection"!==r.type&&(e.push({type:"divider"}),e.push({label:c("setter.common.layer"),key:"layer",children:[{label:c("setter.common.layer_up"),key:"layer-up"},{label:c("setter.common.layer_top"),key:"layer-top"},{label:c("setter.common.layer_down"),key:"layer-down"},{label:c("setter.common.layer_bottom"),key:"layer-bottom"}]})),e}(),onClick:u},trigger:["contextMenu"],open:i?void 0:a,children:e.children})}),nv=JSON.parse('{"version":"5.3.0","objects":[{"type":"rect","version":"5.3.0","originX":"left","originY":"top","left":0,"top":0,"width":1242,"height":1660,"fill":"#ffffff","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"stroke","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"rx":0,"ry":0,"id":"fabritor-sketch","fabritor_desc":"\u6211\u7684\u753B\u677F by fabritor","selectable":false,"hasControls":false},{"type":"f-image","version":"5.3.0","originX":"left","originY":"top","left":-14.18,"top":-50.11,"width":854,"height":1281,"fill":"rgb(0,0,0)","stroke":null,"strokeWidth":0,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1.49,"scaleY":1.49,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"stroke","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"id":"838bb981-f378-43d8-af4d-d2e283d6d767","selectable":true,"hasControls":true,"imageBorder":{},"objects":[{"type":"image","version":"5.3.0","originX":"center","originY":"center","left":0,"top":0,"width":853,"height":1280,"fill":"rgb(0,0,0)","stroke":null,"strokeWidth":0,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"stroke","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"clipPath":{"type":"rect","version":"5.3.0","originX":"center","originY":"center","left":0,"top":0,"width":853,"height":1280,"fill":"rgb(0,0,0)","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"stroke","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"rx":0,"ry":0,"selectable":true,"hasControls":true,"inverted":false,"absolutePositioned":false},"cropX":0,"cropY":0,"selectable":true,"hasControls":true,"src":"https://cdn.pixabay.com/photo/2024/01/04/15/42/sailing-8487722_1280.png","crossOrigin":"anonymous","filters":[]},{"type":"rect","version":"5.3.0","originX":"center","originY":"center","left":0,"top":0,"width":853,"height":1280,"fill":"#00000000","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"rx":0,"ry":0,"selectable":true,"hasControls":true}]},{"type":"f-text","version":"5.3.0","originX":"left","originY":"top","left":371,"top":188.86,"width":500,"height":135.6,"fill":{"type":"linear","coords":{"x1":0,"y1":0,"x2":500,"y2":0},"colorStops":[{"color":"#e45f2b","offset":0},{"color":"#9dbdba","offset":0.47},{"color":"#7d8bae","offset":1}],"offsetX":0,"offsetY":0,"gradientUnits":"pixels","gradientTransform":null},"stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"stroke","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"fontFamily":"SmileySans","fontWeight":"bold","fontSize":120,"text":"fabritor","underline":false,"overline":false,"linethrough":false,"textAlign":"center","fontStyle":"normal","lineHeight":1.3,"textBackgroundColor":"","charSpacing":59,"styles":[],"direction":"ltr","path":null,"pathStartOffset":0,"pathSide":"left","pathAlign":"center","minWidth":20,"splitByGrapheme":true,"id":"ad9d6314-5b03-4886-a101-eb0df5f64153","selectable":true,"hasControls":true},{"type":"f-text","version":"5.3.0","originX":"left","originY":"top","left":250.24,"top":424.33,"width":741.52,"height":207.92,"fill":"#45496a","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"stroke","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"fontFamily":"SourceHanSerif","fontWeight":"normal","fontSize":80,"text":"\u5FEB\u901F\u6784\u5EFA\u5C5E\u4E8E\u81EA\u5DF1\u7684\\n\u56FE\u7247\u7F16\u8F91\u5668","underline":false,"overline":false,"linethrough":false,"textAlign":"center","fontStyle":"normal","lineHeight":1.3,"textBackgroundColor":"","charSpacing":0,"styles":[],"direction":"ltr","path":null,"pathStartOffset":0,"pathSide":"left","pathAlign":"center","minWidth":20,"splitByGrapheme":true,"id":"1a6b8d18-1037-486f-be5f-693bd50f8d60","selectable":true,"hasControls":true}],"clipPath":{"type":"rect","version":"5.3.0","originX":"left","originY":"top","left":0,"top":0,"width":1242,"height":1660,"fill":"#ffffff","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"stroke","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"rx":0,"ry":0,"selectable":true,"hasControls":true},"background":"#ddd","fabritor_schema_version":3.1}');function ng(){var e,t=(0,x.useContext)(j),n=t.isReady,r=t.setReady,i=t.object,o=t.setActiveObject,a=t.editor,l=(0,w._)((0,x.useState)([]),2),s=l[0],c=l[1],u=(0,Q.$G)().t,h=function(e){var t=[],n=e.length;if(!n){c([]);return}for(var r=null==a?void 0:a.canvas.getActiveObject(),i=n-1;i>=0;i--){var o=e[i];o&&o.id!==eg&&(r===o?o.__cover=o.toDataURL():o.__cover||(o.__cover=o.toDataURL()),t.push({cover:o.__cover,group:"group"===o.type,object:o}))}c(t)},f=(e=(0,k._)(function(){return(0,Z.Jh)(this,function(e){switch(e.label){case 0:return r(!1),[4,a.loadFromJSON(nv,!0)];case 1:return e.sent(),a.fhistory.reset(),r(!0),o(null),a.fireCustomModifiedEvent(),[2]}})}),function(){return e.apply(this,arguments)}),d=function(e){a.canvas.discardActiveObject(),a.canvas.setActiveObject(e.object),a.canvas.requestRenderAll()};return(0,x.useEffect)(function(){var e,t=function(){h(e.getObjects())};return n&&(c([]),e=null==a?void 0:a.canvas,t(),e.on({"object:added":t,"object:removed":t,"object:modified":t,"object:skewing":t,"fabritor:object:modified":t})),function(){e&&e.off({"object:added":t,"object:removed":t,"object:modified":t,"object:skewing":t,"fabritor:object:modified":t})}},[n]),(0,b.tZ)("div",{className:"fabritor-panel-wrapper",children:s.length?(0,b.tZ)(tM.Z,{dataSource:s,renderItem:function(e){return(0,b.tZ)(np,{object:e.object,noCareOpen:!0,children:(0,b.tZ)(tM.Z.Item,{className:"fabritor-list-item",style:{border:i===e.object?" 2px solid #ff2222":"2px solid transparent",padding:"10px 16px"},onClick:function(){d(e)},children:(0,b.BX)(U.Z,{justify:"space-between",align:"center",style:{width:"100%",height:40},children:[(0,b.tZ)("img",{src:e.cover,style:{maxWidth:200,maxHeight:34}}),e.group?(0,b.tZ)(tH.Z,{style:{fontSize:18,color:"rgba(17, 23, 29, 0.6)"}}):null]})})})}}):(0,b.tZ)(tE.Z,{image:null,description:(0,b.BX)("div",{children:[(0,b.tZ)(tW.Z,{twoToneColor:"#eb2f96",style:{fontSize:40}}),(0,b.tZ)("p",{style:{color:"#aaa",fontSize:16},children:u("panel.design.start")}),(0,b.tZ)(q.Z,{}),(0,b.tZ)(ei.ZP,{onClick:f,children:u("panel.design.start_demo")})]})})})}var nm=n(5517),nb=n(2973),ny=n(7664),nk=n(1025),nw=n(6411),nZ=n(6156);function nx(e){var t=e.title,n=e.children,r=e.back;return(0,b.tZ)(eN.Z,{bordered:!1,style:{marginLeft:-24,boxShadow:"none"},bodyStyle:{padding:12},title:(0,b.BX)(U.Z,{justify:"space-between",children:[(0,b.tZ)(nZ.Z,{onClick:function(){null==r||r()}}),(0,b.tZ)("p",{children:t})]}),children:n})}var nC=tC.Z.Item;function n_(e){var t=e.back,n=(0,w._)(tC.Z.useForm(),1)[0],r=(0,w._)(tC.Z.useForm(),1)[0],i=(0,w._)((0,x.useState)({value:"fabritor"}),2),o=i[0],a=i[1],l=(0,x.useRef)(null),s=(0,x.useContext)(j).editor,c=(0,Q.$G)().t,u=function(e){a((0,I._)({},o,e))};return(0,x.useEffect)(function(){n.setFieldsValue({value:"fabritor",size:160}),r.setFieldsValue({color:"#000000",bgColor:"#00000000",iconSize:40,errorLevel:"M"})},[]),(0,b.BX)(nx,{title:c("panel.app.qrcode"),back:t,children:[(0,b.BX)(tC.Z,{form:n,onValuesChange:u,children:[(0,b.tZ)(nC,{name:"value",label:c("common.text"),children:(0,b.tZ)(tt.Z,{})}),(0,b.tZ)(nC,{name:"size",label:c("common.size"),children:(0,b.tZ)(tR.Z,{})})]}),(0,b.tZ)(ny.Z,{items:[{key:"1",label:c("panel.app.more"),children:(0,b.BX)(tC.Z,{form:r,onValuesChange:u,children:[(0,b.tZ)(nC,{name:"color",label:c("common.color"),children:(0,b.tZ)(tj,{})}),(0,b.tZ)(nC,{name:"bgColor",label:c("common.background_color"),children:(0,b.tZ)(tj,{})}),(0,b.tZ)(nC,{name:"errorLevel",label:c("panel.app.error_level"),children:(0,b.tZ)(nk.ZP.Group,{options:["L","M","Q","H"]})}),(0,b.tZ)(nC,{name:"icon",label:c("panel.app.image"),children:(0,b.tZ)(tt.Z,{placeholder:c("panel.app.only_image_url")})}),(0,b.tZ)(nC,{name:"iconSize",label:c("panel.app.image_size"),children:(0,b.tZ)(tR.Z,{})})]})}]}),o.value?(0,b.BX)(U.Z,{vertical:!0,align:"center",gap:10,style:{marginTop:16},ref:l,children:[(0,b.tZ)(nw.Z,(0,J._)((0,I._)({type:"canvas"},o),{style:{maxWidth:200}})),(0,b.tZ)(ei.ZP,{type:"primary",onClick:function(){if(o.value&&l.current){var e=l.current.querySelector("canvas");if(e){var t=new Image;t.onload=function(){e8({imageSource:t,canvas:s.canvas})},t.src=e.toDataURL()}}},children:c("panel.app.add")})]}):null]})}var nS=n(6638),nj=n(4168);function nA(e){var t,n=e.back,r=(0,x.useContext)(j).editor,i=(0,w._)((0,y.lr)(),1)[0].get("lng")||"en-US",o=(0,w._)((0,x.useState)("en"),2),a=o[0],l=o[1],s=(t=(0,k._)(function(e){var t;return(0,Z.Jh)(this,function(n){switch(n.label){case 0:if(!((t=r.canvas.getActiveObject())&&"textbox"===t.type))return[3,1];return t.set("text","".concat(t.text).concat(e.native)),r.canvas.requestRenderAll(),[3,3];case 1:return[4,e2({text:e.native,fontSize:80,width:100,canvas:r.canvas})];case 2:n.sent(),n.label=3;case 3:return[2]}})}),function(e){return t.apply(this,arguments)});return(0,x.useEffect)(function(){(null==i?void 0:i.indexOf("en"))===0?l("en"):(null==i?void 0:i.indexOf("zh"))===0?l("zh"):l(i||"en")},[i]),(0,b.tZ)(nx,{title:"Emoji",back:n,children:(0,b.tZ)(nj.Z,{data:nS,perLine:8,set:"native",locale:a,emojiButtonSize:30,emojiSize:22,onEmojiSelect:s})})}var nO=[{title:(0,b.tZ)(Q.cC,{i18nKey:"panel.app.qrcode"}),key:"qrcode",icon:(0,b.tZ)(nm.Z,{style:{fontSize:30}})},{title:(0,b.tZ)(Q.cC,{i18nKey:"panel.app.emoji"}),key:"emoji",icon:(0,b.tZ)(nb.Z,{style:{fontSize:30}})}];function nz(){var e=(0,w._)((0,x.useState)(""),2),t=e[0],n=e[1],r=function(e){n(e.key)},i=function(){n("")};return(0,b.tZ)("div",{children:t?"qrcode"===t?(0,b.tZ)(n_,{back:i}):"emoji"===t?(0,b.tZ)(nA,{back:i}):null:(0,b.tZ)(U.Z,{wrap:"wrap",gap:12,justify:"space-around",style:{padding:"16px 16px 16px 0",marginLeft:-8},children:nO.map(function(e){return(0,b.tZ)(eN.Z,{hoverable:!0,style:{width:120,paddingTop:12},cover:e.icon,bodyStyle:{padding:12},onClick:function(){r(e)},children:(0,b.tZ)(eN.Z.Meta,{description:e.title,style:{textAlign:"center"}})},e.key)})})})}function nF(){var e=(0,w._)((0,y.lr)(),1)[0].get("lng")||"en-US";return(0,b.tZ)(ei.ZP,{shape:"circle",style:{backgroundColor:"#fff",width:40,height:40,border:"none",boxShadow:"0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 9px 28px 8px rgba(0, 0, 0, 0.05)",fontSize:16,fontWeight:"bold"},onClick:function(){window.location.replace("/?lng=".concat("en-US"===e?"zh-CN":"en-US"))},children:"en-US"===e?"En":"\u4E2D"})}var nR=C.Z.Sider,nB={position:"relative",backgroundColor:"#fff",borderRight:"1px solid #e8e8e8"},nP={fontSize:18,marginRight:0},nL=[{label:(0,b.tZ)(Q.cC,{i18nKey:"panel.design.title"}),value:"design",icon:(0,b.tZ)(eT.Z,{style:nP})},{label:(0,b.tZ)(Q.cC,{i18nKey:"panel.text.title"}),value:"text",icon:(0,b.tZ)(eI.Z,{style:nP})},{label:(0,b.tZ)(Q.cC,{i18nKey:"panel.image.title"}),value:"image",icon:(0,b.tZ)(eJ.Z,{style:nP})},{label:(0,b.tZ)(Q.cC,{i18nKey:"panel.material.title"}),value:"shape",icon:(0,b.tZ)(eV.Z,{style:nP})},{label:(0,b.tZ)(Q.cC,{i18nKey:"panel.paint.title"}),value:"paint",icon:(0,b.tZ)(eU.Z,{style:nP})},{label:(0,b.tZ)(Q.cC,{i18nKey:"panel.app.title"}),value:"app",icon:(0,b.tZ)(eY.Z,{style:nP})}];function nX(){var e=(0,x.useContext)(j).editor;return(0,b.BX)(nR,{style:nB,width:360,className:"fabritor-sider",children:[(0,b.tZ)(eH.Z,{tabPosition:"left",style:{flex:1,overflow:"auto"},size:"small",onChange:function(t){(null==e?void 0:e.canvas)&&("paint"===t?e.canvas.isDrawingMode=!0:e.canvas.isDrawingMode=!1)},items:nL.map(function(e){var t;return{label:(0,b.BX)(U.Z,{vertical:!0,justify:"center",children:[(0,b.tZ)("div",{children:e.icon}),(0,b.tZ)("div",{children:e.label})]}),key:e.value,children:"design"===(t=e.value)?(0,b.tZ)(ng,{}):"text"===t?(0,b.tZ)(e3,{}):"image"===t?(0,b.tZ)(ti,{}):"shape"===t?(0,b.tZ)(tZ,{}):"paint"===t?(0,b.tZ)(tX,{}):"app"===t?(0,b.tZ)(nz,{}):null}})}),(0,b.BX)(eW.Z.Group,{shape:"circle",style:{left:10,bottom:14,right:"auto"},children:[(0,b.tZ)(eW.Z,{icon:(0,b.tZ)(eD.Z,{}),href:"https://github.com/sleepy-zone/fabritor-web",target:"_blank"}),(0,b.tZ)(nF,{})]})]})}var nM=n(1912),nE=function(e){var t=(0,Q.$G)().t,n=e.prefixText,r=(0,V._)(e,["prefixText"]);return(0,b.tZ)(tR.Z,(0,I._)({prefix:(0,b.tZ)("span",{style:{color:"rgba(0, 0, 0, 0.5)",marginRight:4},children:n||t("setter.size.width")}),controls:!1,changeOnBlur:!0,min:50,max:8e3,style:{flex:1}},r))};function nH(e){var t=(0,Q.$G)().t,n=e.value,r=e.onChange,i=(0,w._)((0,x.useState)([]),2),o=i[0],a=i[1],l=function(e,t){var n=(0,nM._)(o);n[t]=e,null==r||r(n)};return(0,x.useEffect)(function(){a(n)},[n]),(0,b.BX)(U.Z,{gap:8,children:[(0,b.tZ)(nE,{value:null==o?void 0:o[0],onChange:function(e){l(e,0)}}),(0,b.tZ)(nE,{prefixText:t("setter.size.height"),value:null==o?void 0:o[1],onChange:function(e){l(e,1)}})]})}var nW=tC.Z.Item;function nT(){var e=(0,w._)(tC.Z.useForm(),1)[0],t=(0,x.useContext)(j).editor,n=(0,Q.$G)().t,r=function(e){var n=t.sketch,r=t.canvas,i=eC(e);"string"!=typeof i&&(i=new es.fabric.Gradient(i)),n.set("fill",i),r.requestRenderAll()};return(0,x.useEffect)(function(){if(t){var n=t.sketch;e.setFieldsValue({size:[n.width,n.height],fill:ex(n.fill)})}},[t]),(0,b.BX)(tC.Z,{layout:"vertical",colon:!1,form:e,onValuesChange:function(e){Object.keys(e).forEach(function(n){"size"===n?t.setSketchSize({width:e[n][0],height:e[n][1]}):"fill"===n&&r(e[n])}),t.fireCustomModifiedEvent()},children:[(0,b.tZ)(nW,{label:n("setter.sketch.size"),name:"size",children:(0,b.tZ)(nH,{})}),(0,b.tZ)(nW,{label:n("setter.sketch.fill"),name:"fill",children:(0,b.tZ)(tz,{type:"sketch"})})]})}var nI=n(6118),nJ=n(2638),nV=n(3676),nU=n(3022),nY=n(5605),nD=[{icon:nJ.Z,value:"bold"},{icon:nV.Z,value:"italic"},{icon:nU.Z,value:"underline"},{icon:nY.Z,value:"linethrough"}];function nN(e){var t=e.value,n=e.onChange,r=function(e){n&&n((0,J._)((0,I._)({},t),{[e]:!t[e]}))};return(0,b.tZ)(te.Z.Compact,{block:!0,children:nD.map(function(e){return(0,b.tZ)(ei.ZP,{style:{width:46},icon:(0,b.tZ)(e.icon,{style:{color:(null==t?void 0:t[e.value])?"#1677ff":""}}),onClick:function(){r(e.value)}},e.value)})})}var nG=n(8732),nq=n(6470),nK=n(4180),n$=[{label:(0,b.tZ)(nG.Z,{}),value:"left"},{label:(0,b.tZ)(nq.Z,{}),value:"center"},{label:(0,b.tZ)(nK.Z,{}),value:"right"}];function nQ(e){var t=e.value,n=(0,V._)(e,["value"]);return(0,b.tZ)(nk.ZP.Group,(0,J._)((0,I._)({value:t},n),{options:n$,optionType:"button",buttonStyle:"solid"}))}nG.Z,nq.Z,nK.Z;var n0=n(772),n1=n(2685);function n2(e){var t=e.dataSource,n=e.renderItemChildren,r=(0,V._)(e,["dataSource","renderItemChildren"]);return(0,b.tZ)(tM.Z,(0,I._)({dataSource:t,renderItem:function(e){return(0,b.tZ)(tM.Z.Item,{className:"fabritor-list-item",style:{border:"2px solid transparent",padding:"10px 16px"},onClick:function(){var t;null==e||null===(t=e.onClick)||void 0===t||t.call(e,e)},children:(0,b.tZ)(Y,{style:{height:40},children:n(e)})})}},r))}var n3=n(455);function n6(e){var t=e.open,n=e.setOpen,r=e.title,i=e.children,o=(0,V._)(e,["open","setOpen","title","children"]);return(0,x.useEffect)(function(){t?(document.body.style.overflow="hidden",document.body.scrollTop=0):document.body.style.overflow="auto"},[t]),(0,b.tZ)(n3.Z,(0,J._)((0,I._)({title:null,placement:"right",open:t,mask:!1,maskClosable:!1,width:280,rootStyle:{top:50,outline:"none"},contentWrapperStyle:{boxShadow:"none"},bodyStyle:{padding:16},closeIcon:null},o),{children:(0,b.BX)("div",{children:[(0,b.tZ)(ei.ZP,{type:"link",href:"javascript:void(0);",size:"small",onClick:function(){n(!1)},icon:(0,b.tZ)(nZ.Z,{}),style:{marginLeft:-10},children:void 0===r?"":r}),i]})}))}var n4=tC.Z.Item;function n8(e){var t=(0,w._)(tC.Z.useForm(),1)[0],n=e.value,r=e.onChange,i=(0,Q.$G)().t;return(0,x.useEffect)(function(){n&&t.setFieldsValue(n)},[n]),(0,b.BX)(tC.Z,{form:t,onValuesChange:function(e){r&&r((0,I._)({},n,e))},colon:!1,children:[(0,b.tZ)(n4,{label:(0,b.tZ)("span",{style:{fontSize:15,fontWeight:"bold"},children:i("common.shadow")})}),(0,b.tZ)(n4,{label:i("common.color"),name:"color",children:(0,b.tZ)(tj,{})}),(0,b.tZ)(n4,{label:i("common.blur"),name:"blur",children:(0,b.tZ)(tF.Z,{min:0,max:20})}),(0,b.tZ)(n4,{label:i("common.offset"),name:"offset",children:(0,b.tZ)(tF.Z,{min:-180,max:180})})]})}var n5=n(6599),n7=n(1957),n9=n(5379),re=tC.Z.Item;function rt(e){var t=(0,w._)(tC.Z.useForm(),1)[0],n=e.value,r=e.onChange,i=(0,Q.$G)().t;return(0,x.useEffect)(function(){n&&t.setFieldsValue(n)},[n]),(0,b.BX)(tC.Z,{form:t,onValuesChange:function(e){r&&r((0,I._)({},n,e))},colon:!1,children:[(0,b.BX)(n5.Z,{gutter:16,children:[(0,b.tZ)(n7.Z,{children:(0,b.tZ)(re,{label:(0,b.tZ)("span",{style:{fontSize:15,fontWeight:"bold"},children:i("setter.text.fx.text_path")})})}),(0,b.tZ)(n7.Z,{children:(0,b.tZ)(re,{name:"enable",valuePropName:"checked",children:(0,b.tZ)(n9.Z,{})})})]}),(0,b.tZ)(re,{label:i("common.offset"),name:"offset",children:(0,b.tZ)(tF.Z,{min:-100,max:100})})]})}var rn=tC.Z.Item;function rr(e){var t=(0,w._)(tC.Z.useForm(),1)[0],n=e.value,r=e.onChange,i=(0,Q.$G)().t;return(0,x.useEffect)(function(){n&&t.setFieldsValue(n)},[n]),(0,b.BX)(tC.Z,{form:t,onValuesChange:function(e){r&&r((0,I._)({},n,e))},colon:!1,children:[(0,b.BX)(n5.Z,{gutter:16,children:[(0,b.tZ)(n7.Z,{children:(0,b.tZ)(rn,{label:(0,b.tZ)("span",{style:{fontSize:15,fontWeight:"bold"},children:i("setter.text.fx.fill_image")})})}),(0,b.tZ)(n7.Z,{children:(0,b.tZ)(rn,{name:"enable",valuePropName:"checked",children:(0,b.tZ)(n9.Z,{})})})]}),(0,b.tZ)(rn,{name:"url",children:(0,b.tZ)(tr,{size:"middle",type:"default"})})]})}var ri=tC.Z.Item;function ro(){var e,t,n=(0,w._)(tC.Z.useForm(),1)[0],r=(0,x.useContext)(j),i=r.object,o=r.editor,a=(0,Q.$G)().t,l=(e=(0,k._)(function(e){var t;return(0,Z.Jh)(this,function(n){switch(n.label){case 0:if(!i)return[2];if(!e.enable||!e.url)return i.fill instanceof es.fabric.Pattern&&i.set("fill","#000000"),[2,Promise.resolve()];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e6(e.url)];case 2:return t=n.sent(),i.set("fill",new es.fabric.Pattern({source:t,repeat:"repeat"})),[3,4];case 3:return console.log(n.sent()),[3,4];case 4:return[2]}})}),function(t){return e.apply(this,arguments)}),s=function(e){var t=eC(e);"string"!=typeof t&&(t=new es.fabric.Gradient(t)),i.set("stroke",t)},c=(t=(0,k._)(function(e){var t,n,r,a,c,u,h,f,d;return(0,Z.Jh)(this,function(p){switch(p.label){case 0:if(!i||!o)return[2];t=Object.keys(e),n=!0,r=!1,a=void 0,p.label=1;case 1:p.trys.push([1,9,10,11]),c=t[Symbol.iterator](),p.label=2;case 2:if(n=(u=c.next()).done)return[3,8];if(f=e[h=u.value],"shadow"!==h)return[3,3];return i.shadow={color:f.color,blur:f.blur,offsetX:f.offset,offsetY:f.offset},[3,7];case 3:if("path"!==h)return[3,4];return f.enable?e0(i,f.offset):e1(i),[3,7];case 4:if("pattern"!==h)return[3,6];return[4,l(f)];case 5:return p.sent(),[3,7];case 6:"stroke"===h?s(f):i.set(h,f),p.label=7;case 7:return n=!0,[3,2];case 8:return[3,11];case 9:return d=p.sent(),r=!0,a=d,[3,11];case 10:try{n||null==c.return||c.return()}finally{if(r)throw a}return[7];case 11:return o.canvas.requestRenderAll(),o.fireCustomModifiedEvent(),[2]}})}),function(e){return t.apply(this,arguments)}),u=function(){var e,t,r,o,a=i.fill;n.setFieldsValue({stroke:ex(i.stroke),strokeWidth:i.strokeWidth||0,textBackgroundColor:i.textBackgroundColor,shadow:{color:(null===(e=i.shadow)||void 0===e?void 0:e.color)||i.stroke||"#000000",blur:(null===(t=i.shadow)||void 0===t?void 0:t.blur)||0,offset:(null===(r=i.shadow)||void 0===r?void 0:r.offsetX)||0},path:{enable:!!i.path,offset:eQ(i)},pattern:{enable:a instanceof es.fabric.Pattern,url:null==a?void 0:null===(o=a.source)||void 0===o?void 0:o.src}})};return(0,x.useEffect)(function(){i&&"f-text"===i.type&&u()},[i]),(0,b.BX)(tC.Z,{form:n,onValuesChange:c,colon:!1,style:{marginTop:24},children:[(0,b.tZ)(ri,{label:(0,b.tZ)("span",{style:{fontSize:15,fontWeight:"bold"},children:a("common.stroke")})}),(0,b.tZ)(ri,{label:a("common.stroke_color"),name:"stroke",children:(0,b.tZ)(tz,{})}),(0,b.tZ)(ri,{label:a("common.stroke_width"),name:"strokeWidth",children:(0,b.tZ)(tB,{min:0,max:20})}),(0,b.tZ)(ri,{name:"shadow",style:{marginBottom:0},children:(0,b.tZ)(n8,{})}),(0,b.tZ)(ri,{name:"path",style:{marginBottom:0},children:(0,b.tZ)(rt,{})}),(0,b.tZ)(ri,{name:"pattern",children:(0,b.tZ)(rr,{})})]})}var ra=tC.Z.Item;function rl(){var e,t=(0,x.useContext)(j),n=t.object,r=t.editor,i=(0,w._)(tC.Z.useForm(),1)[0],o=(0,w._)((0,x.useState)(!1),2),a=o[0],l=o[1],s=(0,Q.$G)().t,c=[{icon:(0,b.tZ)(n0.Z,{style:{fontSize:22}}),label:s("setter.text.fx.title"),key:"fx",onClick:function(){l(!0)}}],u=function(e){n.set({fontWeight:(null==e?void 0:e.bold)?"bold":"normal",fontStyle:(null==e?void 0:e.italic)?"italic":"normal",underline:!!e.underline,linethrough:!!e.linethrough})},h=function(e){var t=eC(e);if("string"!=typeof t){t.gradientUnits="pixels";var r=t.coords;t.coords={x1:1===r.x1?n.width:0,y1:1===r.y1?n.height:0,x2:1===r.x2?n.width:0,y2:1===r.y2?n.height:0,r1:0,r2:n.width>n.height?n.width/2:n.height}}"string"!=typeof t&&(t=new es.fabric.Gradient(t)),n.set({fill:t})},f=(e=(0,k._)(function(e){var t,i,o,a,l,s,c,f,d;return(0,Z.Jh)(this,function(p){switch(p.label){case 0:if(!(null===(t=i=Object.keys(e))||void 0===t?void 0:t.length))return[2];o=!0,a=!1,l=void 0,p.label=1;case 1:p.trys.push([1,12,13,14]),s=i[Symbol.iterator](),p.label=2;case 2:if(o=(c=s.next()).done)return[3,11];if("fontStyles"!==(f=c.value))return[3,3];return u(e[f]),[3,9];case 3:if("fontFamily"!==f)return[3,8];p.label=4;case 4:return p.trys.push([4,,6,7]),[4,eb(e[f])];case 5:return p.sent(),[3,7];case 6:return n.set(f,e[f]),[7];case 7:return[3,9];case 8:"fill"===f?h(e[f]):n.getSelectedText()&&"fill"===f?n.setSelectionStyles({fill:e[f]}):(n.set("styles",{}),n.set(f,e[f])),p.label=9;case 9:"fontSize"!==f&&"lineHeight"!==f&&"charSpacing"!==f&&r.fireCustomModifiedEvent(),p.label=10;case 10:return o=!0,[3,2];case 11:return[3,14];case 12:return d=p.sent(),a=!0,l=d,[3,14];case 13:try{o||null==s.return||s.return()}finally{if(a)throw l}return[7];case 14:return r.canvas.requestRenderAll(),[2]}})}),function(t){return e.apply(this,arguments)});return(0,x.useEffect)(function(){i.setFieldsValue({fontFamily:n.fontFamily,fontSize:n.fontSize,fill:ex(n.fill),textAlign:n.textAlign,lineHeight:n.lineHeight,charSpacing:n.charSpacing,fontStyles:{bold:"bold"===n.fontWeight,italic:"italic"===n.fontStyle,underline:n.underline,linethrough:n.linethrough}})},[n]),(0,b.BX)(tA.Fragment,{children:[(0,b.BX)(tC.Z,{form:i,onValuesChange:f,colon:!1,children:[(0,b.tZ)(ra,{name:"fontFamily",label:s("setter.text.font_family"),children:(0,b.tZ)(nI.Z,{options:ev})}),(0,b.tZ)(ra,{name:"fontSize",label:s("setter.text.font_size"),children:(0,b.tZ)(tB,{max:400,onChangeComplete:function(){r.fireCustomModifiedEvent()}})}),(0,b.tZ)(ra,{name:"fill",label:s("setter.text.fill"),children:(0,b.tZ)(tz,{type:"fontColor",defaultColor:"#000000"})}),(0,b.tZ)(ra,{name:"textAlign",label:s("setter.text.text_align"),children:(0,b.tZ)(nQ,{})}),(0,b.tZ)(ra,{name:"fontStyles",label:s("setter.text.font_styles"),children:(0,b.tZ)(nN,{})}),(0,b.tZ)(ra,{name:"charSpacing",label:s("setter.text.char_spacing"),children:(0,b.tZ)(tB,{min:-200,max:800,onChangeComplete:function(){r.fireCustomModifiedEvent()}})}),(0,b.tZ)(ra,{name:"lineHeight",label:s("setter.text.line_height"),children:(0,b.tZ)(tB,{min:.5,max:2.5,step:.01,onChangeComplete:function(){r.fireCustomModifiedEvent()}})})]}),(0,b.tZ)(n2,{dataSource:c,renderItemChildren:function(e){return(0,b.BX)(tA.Fragment,{children:[e.icon,(0,b.tZ)("span",{style:{fontSize:16,fontWeight:"bold",margin:"0 6px 0 10px"},children:e.label}),(0,b.tZ)(n1.Z,{})]})}}),(0,b.tZ)(n6,{open:a,setOpen:l,title:"".concat(s("panel.text.title")," ").concat(s("setter.text.fx.title")),children:(0,b.tZ)(ro,{})})]})}var rs=n(3106);function rc(e){var t=(0,Q.$G)().t,n=e.onChange;return(0,b.tZ)(e9.Z,{content:(0,b.tZ)(tr,{size:"middle",type:"default",onChange:n}),placement:"top",trigger:"click",children:(0,b.tZ)(ei.ZP,{type:"primary",block:!0,icon:(0,b.tZ)(rs.Z,{}),children:t("setter.image.replace")})})}var ru=tC.Z.Item,rh=function(e){var t=e.stroke,n=e.strokeWidth,r=e.strokeDashArray;if(!t)return"none";if(null==r?void 0:r.length){var i=(0,w._)(r,2),o=i[0],a=i[1];return[o/=n/2>1?n/2:n,a/=n/4>1?n/4:n].join(",")}return"line"},rf=function(e){var t=e.type,n=e.strokeWidth;if(!t)return null;if("line"!==t){var r=t.split(",");return r[0]=r[0]*(n/2>1?n/2:n),r[1]=r[1]*(n/4>1?n/4:n),r}return null},rd=[{key:"none",svg:'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M19.071 19.071c-3.905 3.905-10.237 3.905-14.142 0-3.905-3.905-3.905-10.237 0-14.142 3.905-3.905 10.237-3.905 14.142 0 3.905 3.905 3.905 10.237 0 14.142ZM5.482 17.457 17.457 5.482A8.5 8.5 0 0 0 5.482 17.457Zm1.06 1.06A8.501 8.501 0 0 0 18.519 6.544L6.543 18.518Z" fill="currentColor"></path></svg>'},{key:"line",svg:'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><line x2="24" y1="50%" y2="50%" stroke="currentColor" stroke-width="2" shape-rendering="crispEdges"></line></svg>'},{key:"12,2",svg:'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="-1" x2="25" y1="50%" y2="50%" stroke="currentColor" stroke-dasharray="12 2" stroke-width="2" shape-rendering="crispEdges"></line></svg>'},{key:"6,2",svg:'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="1" x2="23" y1="50%" y2="50%" stroke="currentColor" stroke-dasharray="6 2" stroke-width="2" shape-rendering="crispEdges"></line></svg>'},{key:"2,2",svg:'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="1" x2="23" y1="50%" y2="50%" stroke="currentColor" stroke-dasharray="2 2" stroke-width="2" shape-rendering="crispEdges"></line></svg>'}];function rp(e){var t=e.value,n=e.onChange,r=(0,x.useContext)(j).editor,i=(0,Q.$G)().t,o=(0,w._)(tC.Z.useForm(),1)[0],a=function(){r.fireCustomModifiedEvent()};return(0,x.useEffect)(function(){o.setFieldsValue(t)},[t]),(0,b.BX)(tC.Z,{form:o,onValuesChange:function(e){n&&n((0,I._)({},t,e))},colon:!1,children:[(0,b.tZ)(ru,{name:"type",label:i("common.style"),labelCol:{span:24},children:(0,b.tZ)(nk.ZP.Group,{onChange:a,children:rd.map(function(e){return(0,b.tZ)(nk.ZP.Button,{value:e.key,children:(0,b.tZ)("span",{dangerouslySetInnerHTML:{__html:e.svg},style:{display:"inline-flex",alignItems:"center",marginTop:6}})},e.key)})})}),(0,b.tZ)(ru,{name:"stroke",label:i("common.stroke_color"),children:(0,b.tZ)(tj,{onChange:a})}),(0,b.tZ)(ru,{name:"strokeWidth",label:i("common.stroke_width"),children:(0,b.tZ)(tB,{min:1,max:100,onChangeComplete:a})}),(0,b.tZ)(ru,{name:"borderRadius",label:i("common.round"),children:(0,b.tZ)(tB,{min:0,max:200,onChangeComplete:a})})]})}function rv(e){var t=e.value,n=e.onChange,r=(0,w._)((0,x.useState)(!1),2),i=r[0],o=r[1],a=(0,Q.$G)().t;return(0,b.BX)(tA.Fragment,{children:[(0,b.tZ)(ei.ZP,{block:!0,icon:(0,b.tZ)(eV.Z,{}),onClick:function(){o(!0)},children:a("common.border")}),(0,b.tZ)(n6,{open:i,setOpen:o,title:a("common.border"),children:(0,b.tZ)("div",{style:{marginTop:24},children:(0,b.tZ)(rp,{value:t,onChange:n})})})]})}var rg=n(9356),rm=n.n(rg),rb=n(8053),ry=n(6584),rk=n(4769);function rw(e){var t=(0,Q.$G)().t,n=e.object,r=(0,x.useRef)(),i=(0,x.useRef)(null),o=(0,w._)((0,x.useState)(!1),2),a=o[0],l=o[1],s=(0,w._)((0,x.useState)({}),2),c=s[0],u=s[1],h=function(){if(i.current){var e=i.current.getCroppedCanvas().toDataURL();n.setSrc(e,function(){n.set("hasControls",!0),n.group&&n.group.addWithUpdate(),n.canvas.requestRenderAll(),n.setCoords()}),l(!1)}},f=function(e){i.current&&i.current.setAspectRatio(e)};return(0,x.useEffect)(function(){return function(){i.current&&(i.current.destroy(),i.current=null)}},[]),(0,b.BX)("div",{children:[(0,b.tZ)(ei.ZP,{block:!0,icon:(0,b.tZ)(rb.Z,{}),onClick:function(){l(!0);var e=n.getBoundingRect();u({src:n.getSrc(),width:e.width,height:e.height,left:e.left+360,top:e.top+50}),setTimeout(function(){i.current=new(rm())(r.current,{scalable:!1,autoCropArea:1,viewMode:3,toggleDragModeOnDblclick:!1}),n.set("hasControls",!1),n.canvas.requestRenderAll()},66)},children:t("setter.image.crop")}),a?(0,b.BX)("div",{style:{position:"fixed",left:0,top:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,.65)",zIndex:1e3},className:"fabritor-crop-wrapper",children:[(0,b.tZ)("div",{style:{position:"absolute",zIndex:1001,left:c.left,top:c.top-38},children:(0,b.BX)(te.Z.Compact,{block:!0,children:[(0,b.tZ)(ei.ZP,{onClick:function(){f(1)},children:"1:1"}),(0,b.tZ)(ei.ZP,{onClick:function(){f(4/3)},children:"4:3"}),(0,b.tZ)(ei.ZP,{onClick:function(){f(3/4)},children:"3:4"}),(0,b.tZ)(ei.ZP,{onClick:function(){f(16/9)},children:"16:9"}),(0,b.tZ)(ei.ZP,{onClick:function(){f(9/16)},children:"9:16"}),(0,b.tZ)(ei.ZP,{icon:(0,b.tZ)(ry.Z,{}),onClick:function(){l(!1),n.set("hasControls",!0),n.canvas.requestRenderAll()}}),(0,b.tZ)(ei.ZP,{icon:(0,b.tZ)(rk.Z,{}),onClick:h})]})}),(0,b.tZ)("div",{style:{width:c.width,height:c.height,position:"absolute",zIndex:1001,left:c.left,top:c.top},onDoubleClick:h,children:(0,b.tZ)("img",{ref:r,src:c.src,style:{display:"block",maxWidth:"100%"}})})]}):null]})}var rZ=[{label:"\u65E0",value:"none",src:"https://cdn.pixabay.com/photo/2017/02/15/13/18/girl-2068638_1280.jpg"},{label:"\u590D\u53E4",value:"Sepia",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u590D\u53E4.png"},{label:"\u80F6\u7247",value:"Kodachrome",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u80F6\u7247.png"},{label:"\u8001\u7167\u7247",value:"Vintage",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u8001\u7167\u7247.png"},{label:"\u5B9D\u4E3D\u6765",value:"Polaroid",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u5B9D\u4E3D\u6765.png"},{label:"\u6A21\u7CCA",value:"Blur",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u6A21\u7CCA.png"},{label:"\u6D6E\u96D5",value:"Emboss",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u6D6E\u96D5.png"},{label:"\u50CF\u7D20",value:"Pixelate",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u50CF\u7D20.png"},{label:"\u9ED1\u767D",value:"Grayscale",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u9ED1\u767D.png"},{label:"\u8C03\u8272",value:"HueRotation",src:"https://raw.githubusercontent.com/sleepy-zone/fabritor-assets/main/images/\u8C03\u8272.png"}];function rx(e){var t=e.value,n=e.onChange,r=function(e,r){null==n||n((0,J._)((0,I._)({},t),{[r]:e}))};return(0,b.tZ)("div",{className:"fabritor-radio-image-group",children:rZ.map(function(e){return(0,b.BX)("div",{className:"fabritor-radio-image-group-item",onClick:function(){r(e.value,"type")},children:[(0,b.tZ)("div",{className:"fabritor-radio-image-group-img",style:{borderColor:(null==t?void 0:t.type)===e.value?"#ff2222":"#eeeeee"},children:(0,b.tZ)("img",{src:e.src})}),(0,b.tZ)("span",{children:e.label}),"Blur"===e.value&&(null==t?void 0:t.type)==="Blur"?(0,b.tZ)(tF.Z,{min:0,max:1,step:.01,value:(null==t?void 0:t.param)==void 0?.2:null==t?void 0:t.param,onChange:function(e){r(e,"param")}}):null,"Pixelate"===e.value&&(null==t?void 0:t.type)==="Pixelate"?(0,b.tZ)(tF.Z,{min:2,max:20,step:.01,value:(null==t?void 0:t.param)==void 0?4:null==t?void 0:t.param,onChange:function(e){r(e,"param")}}):null,"HueRotation"===e.value&&(null==t?void 0:t.type)==="HueRotation"?(0,b.tZ)(tF.Z,{min:-2,max:2,step:.002,value:(null==t?void 0:t.param)==void 0?0:null==t?void 0:t.param,onChange:function(e){r(e,"param")}}):null]})})})}var rC=tC.Z.Item,r_=function(e){if(!e)return{type:"none"};var t=e.type;return"Blur"===t?{type:t,param:e.blur}:"Pixelate"===t?{type:t,param:e.blocksize}:"HueRotation"===t?{type:t,param:e.rotation}:{type:t}};function rS(){var e=(0,x.useContext)(j),t=e.object,n=e.editor,r=(0,w._)(tC.Z.useForm(),1)[0],i=function(){var e=t.getFilter();console.log(e),r.setFieldsValue({filter:r_(e)})};return(0,x.useEffect)(function(){t&&"f-image"===t.type&&i()},[t]),(0,b.tZ)(tC.Z,{form:r,onValuesChange:function(e){if(e.filter){var r,i=e.filter,o=i.type,a=i.param;r="Emboss"===o?new es.fabric.Image.filters.Convolute({matrix:[1,1,1,1,.7,-1,-1,-1,-1]}):"none"===o?null:new es.fabric.Image.filters[o],"Blur"===o&&(r.blur=void 0==a?.2:a),"Pixelate"===o&&(r.blocksize=void 0==a?4:a),"HueRotation"===o&&(r.rotation=void 0==a?0:a),t.applyFilter(r),t.canvas.requestRenderAll(),n.fireCustomModifiedEvent()}},children:(0,b.tZ)(rC,{name:"filter",children:(0,b.tZ)(rx,{})})})}var rj=tC.Z.Item;function rA(){var e=(0,x.useContext)(j),t=e.object,n=e.editor,r=(0,Q.$G)().t,i=(0,w._)(tC.Z.useForm(),1)[0],o=(0,w._)((0,x.useState)(!1),2),a=o[0],l=o[1],s=[{icon:(0,b.tZ)(n0.Z,{style:{fontSize:22}}),label:r("setter.image.filter"),key:"fx",onClick:function(){l(!0)}}],c=function(e){e&&t.setSrc(e,function(){n.canvas.requestRenderAll(),n.fireCustomModifiedEvent()})},u=function(e){var r=e||{},i=r.type,o=r.stroke,a=r.strokeWidth,l=r.borderRadius;"none"===i?t.setBorder({stroke:null,borderRadius:l}):t.setBorder({stroke:void 0===o?"#000000":o,strokeWidth:a,borderRadius:l,strokeDashArray:rf(e)}),n.canvas.requestRenderAll()};return(0,x.useEffect)(function(){if(t){var e=t.getBorder();i.setFieldsValue({border:(0,J._)((0,I._)({type:rh(e)},e),{stroke:e.stroke||"#000000"}),opacity:t.opacity})}},[t]),(0,b.BX)(tA.Fragment,{children:[(0,b.BX)(tC.Z,{form:i,onValuesChange:function(e){e.img&&c(e.img),e.flip&&(t.set(e.flip,!t[e.flip]),n.canvas.requestRenderAll(),n.fireCustomModifiedEvent()),e.border&&u(e.border)},colon:!1,children:[(0,b.tZ)(rj,{name:"img",children:(0,b.tZ)(rc,{})}),(0,b.BX)(n5.Z,{gutter:8,children:[(0,b.tZ)(n7.Z,{span:12,children:(0,b.tZ)(rj,{children:(0,b.tZ)(rw,{object:t})})}),(0,b.tZ)(n7.Z,{span:12,children:(0,b.tZ)(rj,{name:"border",children:(0,b.tZ)(rv,{})})})]})]}),(0,b.tZ)(n2,{dataSource:s,renderItemChildren:function(e){return(0,b.BX)(tA.Fragment,{children:[e.icon,(0,b.tZ)("span",{style:{fontSize:16,fontWeight:"bold",margin:"0 6px 0 10px"},children:e.label}),(0,b.tZ)(n1.Z,{})]})}}),(0,b.tZ)(n6,{open:a,setOpen:l,title:r("setter.image.filter"),children:(0,b.tZ)(rS,{})})]})}var rO=tC.Z.Item,rz=rd.slice(1);function rF(){var e=(0,x.useContext)(j),t=e.object,n=e.editor,r=(0,Q.$G)().t,i=(0,w._)(tC.Z.useForm(),1)[0];return(0,x.useEffect)(function(){i.setFieldsValue({stroke:t.stroke||"#000000",type:rh(t),strokeWidth:t.strokeWidth,round:"round"===t.strokeLineCap})},[t]),(0,b.BX)(tC.Z,{form:i,onValuesChange:function(e){var r=Object.keys(e);if(null==r?void 0:r.length){var i=!0,o=!1,a=void 0;try{for(var l,s=r[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var c=l.value;switch(c){case"stroke":t.set("stroke",e[c]),n.fireCustomModifiedEvent();break;case"strokeWidth":t.setStrokeWidth(e[c]);break;case"round":t.set("strokeLineCap",e[c]?"round":"butt"),n.fireCustomModifiedEvent();break;case"type":t.set("strokeDashArray",rf({type:e[c],strokeWidth:t.strokeWidth})),n.fireCustomModifiedEvent()}}}catch(u){o=!0,a=u}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}t.setCoords(),n.canvas.requestRenderAll()}},colon:!1,children:[(0,b.tZ)(rO,{name:"stroke",label:r("common.stroke_color"),children:(0,b.tZ)(tj,{})}),(0,b.tZ)(rO,{name:"type",label:r("common.style"),labelCol:{span:24},children:(0,b.tZ)(nk.ZP.Group,{children:rz.map(function(e){return(0,b.tZ)(nk.ZP.Button,{value:e.key,children:(0,b.tZ)("span",{dangerouslySetInnerHTML:{__html:e.svg},style:{display:"inline-flex",alignItems:"center",marginTop:6}})},e.key)})})}),(0,b.tZ)(rO,{name:"strokeWidth",label:r("common.stroke_width"),children:(0,b.tZ)(tB,{min:1,max:50,onChangeComplete:function(){n.fireCustomModifiedEvent()}})}),(0,b.tZ)(rO,{name:"round",label:r("common.round"),valuePropName:"checked",children:(0,b.tZ)(n9.Z,{})})]})}var rR=tC.Z.Item;function rB(){var e=(0,x.useContext)(j),t=e.object,n=e.editor,r=(0,Q.$G)().t,i=(0,w._)(tC.Z.useForm(),1)[0],o=function(e){var r=e||{},i=r.type,o=r.stroke,a=r.strokeWidth,l=r.borderRadius;"none"===i?t.set({stroke:null,strokeWidth:1}):t.set({stroke:void 0===o?"#000":o,strokeWidth:a,strokeDashArray:rf({type:i,strokeWidth:a})}),"rect"===t.type?t.set({rx:l,ry:l}):t.set("strokeLineJoin",l>0?"round":"miter"),t.setCoords(),n.canvas.requestRenderAll()};return(0,x.useEffect)(function(){t&&i.setFieldsValue({border:{type:rh(t),stroke:t.stroke||"#000000",strokeWidth:t.strokeWidth||1,borderRadius:t.rx||t.ry||("round"===t.strokeLineJoin?100:0)},fill:ex(t.fill)})},[t]),(0,b.BX)(tC.Z,{form:i,onValuesChange:function(e){if(e.fill){var r=eC(e.fill);"string"!=typeof r&&(r=new es.fabric.Gradient(r)),t.set("fill",r),n.canvas.requestRenderAll()}e.border&&o(e.border)},colon:!1,children:[(0,b.tZ)(rR,{name:"fill",label:r("common.color"),children:(0,b.tZ)(tz,{defaultColor:"#000000"})}),(0,b.tZ)(rR,{name:"border",label:(0,b.tZ)("span",{style:{fontWeight:"bold",fontSize:15},children:r("common.border")}),labelCol:{span:24},children:(0,b.tZ)(rp,{})})]})}var rP=n(5285),rL=n(387),rX=n(5538),rM=n(7388),rE=n(144),rH=n(1548),rW=n(9956),rT=n(8979);function rI(e){var t=e.value,n=e.onChange,r=e.onChangeComplete;return(0,b.tZ)(e9.Z,{content:(0,b.tZ)(tB,{style:{width:200},min:0,max:1,step:.01,value:t,onChange:n,onChangeComplete:r}),placement:"bottom",trigger:"click",children:(0,b.tZ)("span",{children:(0,b.tZ)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24",children:(0,b.BX)("g",{fill:"currentColor","fill-rule":"evenodd",children:[(0,b.tZ)("path",{d:"M3 2h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1z"}),(0,b.tZ)("path",{d:"M11 2h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1z",opacity:".45"}),(0,b.tZ)("path",{d:"M19 2h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1z",opacity:".15"}),(0,b.tZ)("path",{d:"M7 6h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1z",opacity:".7"}),(0,b.tZ)("path",{d:"M15 6h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm0 8h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1z",opacity:".3"})]})})})})}var rJ=[{key:"flipX",label:(0,b.tZ)(Q.cC,{i18nKey:"setter.common.flip_x"})},{key:"flipY",label:(0,b.tZ)(Q.cC,{i18nKey:"setter.common.flip_y"})}];function rV(e){var t=e.onChange;return(0,b.tZ)(eo.Z,{placement:"bottom",trigger:["click"],menu:{items:rJ,onClick:function(e){var n=e.key;null==t||t(n)}},arrow:!0,children:(0,b.tZ)("span",{children:(0,b.BX)("svg",{width:"22",height:"22",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,b.tZ)("path",{d:"M30 10H40C41.8856 10 42.8284 10 43.4142 10.5858C44 11.1716 44 12.1144 44 14V34C44 35.8856 44 36.8284 43.4142 37.4142C42.8284 38 41.8856 38 40 38H30",stroke:"currentColor","stroke-width":"4","stroke-linecap":"square","stroke-linejoin":"miter"}),(0,b.tZ)("path",{d:"M18 10H8C6.11438 10 5.17157 10 4.58579 10.5858C4 11.1716 4 12.1144 4 14V34C4 35.8856 4 36.8284 4.58579 37.4142C5.17157 38 6.11438 38 8 38H18",stroke:"currentColor","stroke-width":"4","stroke-linecap":"square","stroke-linejoin":"miter"}),(0,b.tZ)("path",{d:"M24 6V42",stroke:"currentColor","stroke-width":"4","stroke-linecap":"square","stroke-linejoin":"miter"})]})})})}var rU=tC.Z.Item,rY=function(e){var t=e.value,n=e.onChange,r=(0,V._)(e,["value","onChange"]),i=(0,w._)((0,x.useState)(t),2),o=i[0],a=i[1];return(0,x.useEffect)(function(){a(t)},[t]),(0,b.tZ)(tR.Z,(0,I._)({style:{width:"100%"},controls:!1,step:1,precision:2,changeOnBlur:!0,value:o,onChange:a,onPressEnter:function(){null==n||n(o)}},r))},rD=["textbox","f-text","rect"];function rN(){var e=(0,x.useContext)(j),t=e.editor,n=e.object,r=(0,Q.$G)().t,i=(0,w._)((0,x.useState)(!1),2),o=i[0],a=i[1],l=(0,x.useRef)(!1),s=(0,w._)(tC.Z.useForm(),1)[0],c=function(e,t){var r=t-n.strokeWidth;"width"===e?l.current?n.set({width:r,scaleX:1,scaleY:1}):n.scaleToWidth(r,!0):"height"===e&&(l.current?n.set({height:r,scaleX:1,scaleY:1}):n.scaleToHeight(r,!0))},u=function(){s.setFieldsValue({width:n.getScaledWidth(),height:n.getScaledHeight(),lockRatio:!0,left:n.left,top:n.top,angle:n.angle})},h=function(){u()};return(0,x.useEffect)(function(){(o&&n&&!n.group||"activeSelection"!==n.type)&&(l.current=rD.includes(n.type),u(),n.on("modified",h))},[n,o]),(0,b.BX)(tA.Fragment,{children:[(0,b.tZ)(ei.ZP,{block:!0,onClick:function(){a(!0)},children:r("setter.common.adjust_position")}),(0,b.tZ)(n6,{open:o,setOpen:a,title:r("setter.common.adjust_position"),children:(0,b.tZ)("div",{style:{marginTop:24},children:(0,b.BX)(tC.Z,{form:s,layout:"vertical",colon:!1,onValuesChange:function(e){Object.keys(e).forEach(function(t){var r=e[t];"width"===t||"height"===t?(c(t,r),u()):n.set(t,r)}),t.canvas.requestRenderAll(),t.fireCustomModifiedEvent()},children:[(0,b.BX)(n5.Z,{gutter:8,children:[(0,b.tZ)(n7.Z,{span:8,children:(0,b.tZ)(rU,{label:"".concat(r("setter.size.width"),"(").concat(r("setter.common.px"),")"),name:"width",children:(0,b.tZ)(rY,{min:1})})}),(0,b.tZ)(n7.Z,{span:8,children:(0,b.tZ)(rU,{label:"".concat(r("setter.size.height"),"(").concat(r("setter.common.px"),")"),name:"height",children:(0,b.tZ)(rY,{min:1})})}),(0,b.tZ)(n7.Z,{span:8,children:(0,b.tZ)(rU,{label:r("setter.common.lock_ratio"),name:"lockRatio",valuePropName:"checked",children:(0,b.tZ)(n9.Z,{disabled:!0})})})]}),(0,b.BX)(n5.Z,{gutter:8,children:[(0,b.tZ)(n7.Z,{span:8,children:(0,b.tZ)(rU,{label:"X(".concat(r("setter.common.px"),")"),name:"left",children:(0,b.tZ)(rY,{})})}),(0,b.tZ)(n7.Z,{span:8,children:(0,b.tZ)(rU,{label:"Y(".concat(r("setter.common.px"),")"),name:"top",children:(0,b.tZ)(rY,{})})}),(0,b.tZ)(n7.Z,{span:8,children:(0,b.tZ)(rU,{label:"".concat(r("setter.common.rotate"),"(\xb0)"),name:"angle",children:(0,b.tZ)(rY,{min:-360,max:360,precision:0})})})]})]})})})]})}var rG=[{label:(0,b.tZ)(Q.cC,{i18nKey:"setter.common.center"}),icon:rP.Z,key:"center"},{label:(0,b.tZ)(Q.cC,{i18nKey:"setter.common.align_left"}),icon:nG.Z,key:"left"},{label:(0,b.tZ)(Q.cC,{i18nKey:"setter.common.center_h"}),icon:nq.Z,key:"centerH"},{label:(0,b.tZ)(Q.cC,{i18nKey:"setter.common.align_right"}),icon:nK.Z,key:"right"},{label:(0,b.tZ)(Q.cC,{i18nKey:"setter.common.align_top"}),icon:rL.Z,key:"top"},{label:(0,b.tZ)(Q.cC,{i18nKey:"setter.common.center_v"}),icon:rX.Z,key:"centerV"},{label:(0,b.tZ)(Q.cC,{i18nKey:"setter.common.align_bottom"}),icon:rM.Z,key:"bottom"}];function rq(){var e=(0,x.useContext)(j),t=e.object,n=e.editor,r=(0,Q.$G)().t,i=(0,w._)((0,x.useState)(!1),2),o=i[0],a=i[1],l=(0,w._)((0,x.useState)(1),2),s=l[0],c=l[1],u=function(e){switch(e){case"center":n.canvas.viewportCenterObject(t),t.setCoords();break;case"left":t.set("left",0);break;case"centerH":n.canvas.viewportCenterObjectH(t),t.setCoords();break;case"right":t.set("left",n.sketch.width-t.width);break;case"top":t.set("top",0);break;case"centerV":n.canvas.viewportCenterObjectV(t),t.setCoords();break;case"bottom":t.set("top",n.sketch.height-t.height)}n.canvas.requestRenderAll(),n.fireCustomModifiedEvent()};return((0,x.useEffect)(function(){t&&(a(t.lockMovementX),c(t.opacity))},[t]),t&&t.id!==eg)?(0,b.BX)(tA.Fragment,{children:[(0,b.BX)(D,{height:30,gap:8,justify:"space-between",children:[(0,b.tZ)(G,{tooltipProps:{placement:"top"},onClick:function(){t.set({lockMovementX:!o,lockMovementY:!o,hasControls:!!o}),n.canvas.requestRenderAll(),a(!o),n.fireCustomModifiedEvent()},title:r(o?"setter.common.unlock":"setter.common.lock"),children:o?(0,b.tZ)(rE.Z,{style:{fontSize:20}}):(0,b.tZ)(rH.Z,{style:{fontSize:20}})}),(0,b.tZ)(G,{tooltipProps:{placement:"top"},title:r("setter.common.opacity"),children:(0,b.tZ)(rI,{value:s,onChange:function(e){t.set("opacity",e),c(e),n.canvas.requestRenderAll()},onChangeComplete:function(){n.fireCustomModifiedEvent()}})}),(0,b.tZ)(G,{tooltipProps:{placement:"top"},title:r("setter.common.create_a_copy"),onClick:(0,k._)(function(){return(0,Z.Jh)(this,function(e){switch(e.label){case 0:return[4,ni(n.canvas,t)];case 1:return e.sent(),[4,no(n.canvas)];case 2:return e.sent(),[2]}})}),children:(0,b.tZ)(rW.Z,{style:{fontSize:20}})}),(0,b.tZ)(G,{tooltipProps:{placement:"top"},title:r("setter.common.del"),onClick:function(){na(null,n.canvas)},children:(0,b.tZ)(rT.Z,{style:{fontSize:20}})}),"f-image"===t.type?(0,b.tZ)(G,{tooltipProps:{placement:"top"},title:r("setter.common.flip"),children:(0,b.tZ)(rV,{onChange:function(e){t.set(e,!t[e]),n.canvas.requestRenderAll(),n.fireCustomModifiedEvent()}})}):null]}),(0,b.tZ)(q.Z,{style:{margin:"16px 0"}}),(0,b.tZ)("span",{style:{fontWeight:"bold"},children:r("setter.common.align")}),(0,b.tZ)(D,{height:30,gap:8,justify:"space-between",style:{marginTop:16},children:rG.map(function(e){return(0,b.tZ)(G,{tooltipProps:{placement:"top"},title:e.label,onClick:function(){u(e.key)},children:(0,b.tZ)(e.icon,{style:{fontSize:20}})},e.key)})}),(0,b.tZ)(q.Z,{style:{margin:"16px 0"}}),(0,b.tZ)(rN,{})]}):null}function rK(){var e=(0,x.useContext)(j),t=e.object,n=e.editor,r=(0,Q.$G)().t;return t&&("group"===t.type||"activeSelection"===t.type)?(0,b.tZ)("div",{children:"group"===t.type?(0,b.tZ)(ei.ZP,{type:"primary",block:!0,onClick:function(){ns(n.canvas,t)},children:r("setter.group.ung")}):(0,b.tZ)(ei.ZP,{type:"primary",block:!0,onClick:function(){nl(n.canvas,t)},children:r("setter.group.g")})}):null}function r$(){var e=(0,x.useContext)(j),t=e.object,n=e.editor,r=(0,w._)((0,x.useState)({}),2),i=r[0],o=r[1];return((0,x.useEffect)(function(){if(t){var e=t.shadow;o({color:t.stroke,width:t.strokeWidth,fill:ex(t.fill||"#ffffff"),shadow:{color:(null==e?void 0:e.color)||"#000000",width:(null==e?void 0:e.blur)||0,offset:(null==e?void 0:e.offsetX)||0}})}},[t]),t&&"path"===t.type)?(0,b.tZ)(tL,{showFillConfig:null==t?void 0:t.sub_type,shouldFireEvent:!0,value:i,onChange:function(e){if(e.color&&t.set("stroke",e.color),e.width&&t.set("strokeWidth",e.width),e.fill){var r=eC(e.fill);"string"!=typeof r&&(r=new es.fabric.Gradient(r)),t.set("fill",r)}if(e.shadow){var i=t.shadow,o=i?i.toObject():{},a={blur:e.shadow.width||o.blur,offsetX:e.shadow.offset||o.offsetX,offsetY:e.shadow.offset||o.offsetY,affectStroke:!0,color:e.shadow.color||o.color||"#000000"};t.set("shadow",new es.fabric.Shadow(a))}n.canvas.requestRenderAll()}}):null}var rQ=tC.Z.Item;function r0(){var e=(0,w._)(tC.Z.useForm(),1)[0],t=(0,x.useContext)(j),n=t.editor,r=t.object,i=(0,Q.$G)().t;return(0,x.useEffect)(function(){if(null==r?void 0:r.sub_type){if("path"===r.type)e.setFieldsValue({stroke:r.stroke});else{var t=r.getObjects();e.setFieldsValue({stroke:t[1].stroke,fill:t[0].stroke})}}},[n]),(0,b.BX)(tC.Z,{colon:!1,form:e,onValuesChange:function(e){Object.keys(e).forEach(function(t){if("path"===r.type)r.set("stroke",e[t]);else{var n=r.getObjects();"stroke"===t?n[1].set("stroke",e[t]):"fill"===t&&n[0].set("stroke",e[t])}}),n.canvas.requestRenderAll(),n.fireCustomModifiedEvent()},children:[(0,b.tZ)(rQ,{label:i("common.stroke"),name:"stroke",children:(0,b.tZ)(tj,{})}),(null==r?void 0:r.type)==="group"?(0,b.tZ)(rQ,{label:i("common.fill"),name:"fill",children:(0,b.tZ)(tj,{})}):null]})}var r1=C.Z.Sider,r2=eB.Z.Title,r3={position:"relative",backgroundColor:"#fff",borderLeft:"1px solid #e8e8e8"};function r6(){var e,t,n=(0,x.useContext)(j),r=n.object,i=n.isReady,o=(0,Q.$G)().t,a=(null==r?void 0:null===(t=r.get)||void 0===t?void 0:t.call(r,"type"))||"";console.log("objectType",a,r);var l=function(){if(!i)return null;if(!r||r.id===eg)return o("setter.sketch.title");switch(a){case"textbox":case"f-text":return o("panel.text.title");case"rect":case"circle":case"triangle":case"polygon":case"ellipse":return o("panel.material.shape");case"line":case"f-line":case"f-arrow":case"f-tri-arrow":return o("panel.material.line");case"f-image":case"image":return o("panel.image.title");case"path":if(null==r?void 0:r.sub_type){if((null==r?void 0:r.sub_type)==="rough")return o("panel.material.hand_drawn");return o("panel.material.shape")}return o("panel.paint.title");case"group":if((null==r?void 0:r.sub_type)==="rough")return o("panel.material.hand_drawn");return o("setter.group.title");case"activeSelection":return o("setter.group.title");default:return o("setter.sketch.title")}};return(0,b.BX)(r1,{style:r3,width:280,className:"fabritor-sider",children:[l()?(0,b.tZ)(D,{style:{borderBottom:"1px solid #e8e8e8",paddingLeft:16},children:(0,b.tZ)(r2,{level:5,children:l()})}):null,(0,b.BX)("div",{style:{padding:16},children:[(e=function(){if(!i)return null;if(!r||r.id===eg)return(0,b.tZ)(nT,{});switch(a){case"textbox":case"f-text":return(0,b.tZ)(rl,{});case"rect":case"circle":case"triangle":case"polygon":case"ellipse":return(0,b.tZ)(rB,{});case"f-line":case"f-arrow":case"f-tri-arrow":return(0,b.tZ)(rF,{});case"f-image":return(0,b.tZ)(rA,{});case"path":if((null==r?void 0:r.sub_type)==="rough")return(0,b.tZ)(r0,{});return(0,b.tZ)(r$,{});case"group":if((null==r?void 0:r.sub_type)==="rough")return(0,b.tZ)(r0,{});return(0,b.tZ)(rK,{});case"activeSelection":return(0,b.tZ)(rK,{});default:return null}}())?(0,b.BX)(tA.Fragment,{children:[e,(0,b.tZ)(q.Z,{})]}):null,(0,b.tZ)(rq,{})]})]})}var r4=n(5862),r8=n(2267),r5=n(5766),r7=function(){es.fabric.Image.prototype.needsItsOwnCache=function(){return!1},es.fabric.perfLimitSizeTotal=16777216,Object.keys(ed).forEach(function(e){es.fabric.Object.prototype[e]=ed[e]});var e={borderColor:"#cccddd",borderDashArray:[7,10],borderScaleFactor:3,padding:10};Object.keys(e).forEach(function(t){es.fabric.ActiveSelection.prototype[t]=e[t],es.fabric.Group.prototype[t]=e[t]}),es.fabric.Group.prototype.subTargetCheck=!0},r9=n(9975),ie=n(6259),it=function(){function e(t){(0,r4._)(this,e),(0,r5._)(this,"historyUndo",void 0),(0,r5._)(this,"historyRedo",void 0),(0,r5._)(this,"saving",void 0),(0,r5._)(this,"doing",void 0),(0,r5._)(this,"currentState",void 0),(0,r5._)(this,"canvas",void 0),(0,r5._)(this,"editor",void 0),this.historyUndo=[],this.historyRedo=[],this.canvas=t.canvas,this.editor=t,this.saving=!1,this.doing=!1,this.currentState=this._getJSON(),this.init()}return(0,r8._)(e,[{key:"_checkHistoryUndoLength",value:function(){this.historyUndo.length>100&&this.historyUndo.shift()}},{key:"_checkHistoryRedoLength",value:function(){this.historyRedo.length>100&&this.historyRedo.shift()}},{key:"_historySaveAction",value:function(){if(!this.doing&&!this.saving){this.saving=!0;var e=this.currentState;this.historyUndo.push(e),this._checkHistoryUndoLength(),this.currentState=this._getJSON(),this.saving=!1}}},{key:"_getJSON",value:function(){return JSON.stringify(this.editor.canvas2Json())}},{key:"_historyEvents",value:function(){return{"object:added":this._historySaveAction.bind(this),"object:removed":this._historySaveAction.bind(this),"object:modified":this._historySaveAction.bind(this),"object:skewing":this._historySaveAction.bind(this),"fabritor:object:modified":this._historySaveAction.bind(this)}}},{key:"init",value:function(){this.canvas.on(this._historyEvents())}},{key:"dispose",value:function(){this.canvas.off(this._historyEvents())}},{key:"undo",value:function(){var e=this;return(0,k._)(function(){var t;return(0,Z.Jh)(this,function(n){switch(n.label){case 0:if(!(t=e.historyUndo.pop()))return[3,2];return e.doing=!0,e.historyRedo.push(e.currentState),e._checkHistoryRedoLength(),e.currentState=t,[4,e.editor.loadFromJSON(t)];case 1:n.sent(),e.doing=!1,e.canvas.fire("fabritor:history:undo"),n.label=2;case 2:return[2]}})})()}},{key:"redo",value:function(){var e=this;return(0,k._)(function(){var t;return(0,Z.Jh)(this,function(n){switch(n.label){case 0:if(!(t=e.historyRedo.pop()))return[3,2];return e.doing=!0,e.historyUndo.push(e.currentState),e._checkHistoryUndoLength(),e.currentState=t,[4,e.editor.loadFromJSON(t)];case 1:n.sent(),e.doing=!1,e.canvas.fire("fabritor:history:redo"),n.label=2;case 2:return[2]}})})()}},{key:"canUndo",value:function(){return this.historyUndo.length>0}},{key:"canRedo",value:function(){return this.historyRedo.length>0}},{key:"reset",value:function(){this.historyRedo=[],this.historyUndo=[],this.saving=!1,this.doing=!1,this.currentState=this._getJSON()}}]),e}(),ir=function(){function e(t){(0,r4._)(this,e),(0,r5._)(this,"canvas",void 0),(0,r5._)(this,"editor",void 0),(0,r5._)(this,"saving",void 0),(0,r5._)(this,"canSave",void 0),this.canvas=t.canvas,this.editor=t,this.saving=!1,this.canSave=!0,this.init()}return(0,r8._)(e,[{key:"init",value:function(){}},{key:"dispose",value:function(){}},{key:"setCanSave",value:function(e){this.canSave=e}},{key:"autoSaveAction",value:function(){if(!this.saving){this.saving=!0;try{this.canSave&&localStorage.setItem("fabritor_web_json",this._getJSON())}catch(e){console.log(e)}this.saving=!1}}},{key:"_getJSON",value:function(){return JSON.stringify(this.editor.canvas2Json())}},{key:"initAutoSaveEvents",value:function(){return{"object:added":this.autoSaveAction.bind(this),"object:removed":this.autoSaveAction.bind(this),"object:modified":this.autoSaveAction.bind(this),"object:skewing":this.autoSaveAction.bind(this),"fabritor:object:modified":this.autoSaveAction.bind(this)}}},{key:"loadFromLocal",value:function(){var e=this;return(0,k._)(function(){var t,n;return(0,Z.Jh)(this,function(r){switch(r.label){case 0:return[3,5];case 1:if(r.trys.push([1,4,,5]),!(t=localStorage.getItem("fabritor_web_json")))return[3,3];return n=JSON.parse(t),[4,e.editor.loadFromJSON(n)];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:return console.log(r.sent()),[3,5];case 5:return[2]}})})()}}]),e}(),ii=function(e){var t=e.items,n=e.canvas,r=(0,V._)(e,["items","canvas"]),i=new es.fabric.Group(t,(0,I._)({id:ey()},r));return n.add(i),i},io=es.fabric.util.object.clone,ia="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign minWidth splitByGrapheme".split(" "),il=function(){es.fabric.FText=es.fabric.util.createClass(es.fabric.Textbox,{type:"f-text",padding:0,paintFirst:"stroke",initDimensions:function(){if(!this.__skipDimension){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces();var e=this.calcTextHeight();this.path?this.height=this.path.height>e?this.path.height:e:this.height=e,this.saveState({propertySet:"_dimensionAffectingProps"})}},toObject:function(e){var t=ia.concat(e),n=this.callSuper("toObject",t);return n.styles=es.fabric.util.stylesToArray(this.styles,this.text),n.path&&(n.path=this.path.toObject()),n}}),es.fabric.FText.fromObject=function(e,t){var n=io(e),r=e.path;return delete n.path,es.fabric.Object._fromObject("FText",n,function(n){n.styles=es.fabric.util.stylesFromArray(e.styles,e.text),r?es.fabric.Object._fromObject("Path",r,function(e){n.set("path",e),t(n)},"path"):t(n)},"text")}},is=function(){var e;e=es.fabric.util.createClass(es.fabric.Group,{type:"f-image",initialize(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.image,r=e.imageBorder,i=void 0===r?{}:r,o=(0,V._)(e,["image","imageBorder"]);n.set({originX:"center",originY:"center"}),this.img=n,this.borderRect=this._createBorderRect(i),this.img.clipPath=this._createClipPath(),this.callSuper("initialize",[this.img,this.borderRect],(0,I._)({borderColor:"#FF2222",borderDashArray:null,borderScaleFactor:2,padding:0,subTargetCheck:!1,imageBorder:i},o),t)},_createBorderRect(e){var t=e.stroke,n=e.strokeWidth,r=e.borderRadius,i={width:this.img.getScaledWidth(),height:this.img.getScaledHeight(),rx:r||0,ry:r||0,originX:"center",originY:"center",fill:"#00000000",paintFirst:"fill"};return t&&(i.stroke=t),n&&(i.strokeWidth=n),new es.fabric.Rect(i)},_createClipPath(){var e=this.img.width,t=this.img.height;return new es.fabric.Rect({originX:"center",originY:"center",width:e,height:t,rx:this.borderRect.rx||0,ry:this.borderRect.ry||0})},setSrc(e,t){var n=this;this.img.setSrc(e,function(){var e=n.img.getScaledWidth(),r=n.img.getScaledHeight();n.img.setCoords(),n.borderRect.set({width:e,height:r,dirty:!0}),n.img.set({clipPath:n._createClipPath(),dirty:!0}),n.addWithUpdate(),t&&t()})},getSrc(){return this.img.getSrc()},setBorder(e){this.borderRect.set({stroke:e.stroke||null,strokeWidth:e.strokeWidth||1,rx:e.borderRadius||0,ry:e.borderRadius||0,strokeDashArray:e.strokeDashArray||null}),this.img.setCoords(),this.img.set({clipPath:this._createClipPath(),dirty:!0}),this.imageBorder=(0,I._)({},e),this.addWithUpdate()},getBorder(){return this.imageBorder},applyFilter(e){try{this.img.filters=e?[e]:[],this.img.applyFilters()}catch(t){console.log(t)}},applyFilterValue(e,t){var n=this.getFilter();n&&(n[e]=t,this.img.filters=[n],this.img.applyFilters())},getFilter(){return this.img.filters[0]}}),es.fabric.FImage=e,es.fabric.FImage.fromObject=function(e,t){var n=e.objects,r=(0,V._)(e,["objects"]),i=(0,I._)({},n[0]);es.fabric.Image.fromObject(i,function(e){t(new es.fabric.FImage((0,I._)({image:e},r),!0))})}},ic=es.fabric.util.object.extend,iu=function(){es.fabric.FLine=es.fabric.util.createClass(es.fabric.Line,{type:"f-line",padding:6,borderColor:"#00000000",setStrokeWidth(e){this.set("strokeWidth",e)},setStrokeDashArray(e){this.set("strokeDashArray",e)},setStrokeLineCap(e){this.set("strokeLineCap",e?"round":"butt")},toObject(e){return ic(this.callSuper("toObject",e),{x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2})}}),es.fabric.FLine.fromObject=function(e,t){var n=(0,I._)({},e);n.points=[e.x1,e.y1,e.x2,e.y2],es.fabric.Object._fromObject("FLine",n,function(e){delete e.points,t&&t(e)},"points")}},ih=es.fabric.util.object.extend,id=function(){es.fabric.FArrow=es.fabric.util.createClass(es.fabric.Line,{type:"f-arrow",borderColor:"#00000000",_render:function(e){this.callSuper("_render",e),e.save(),this.oldArrowInfo||(this.oldArrowInfo={left:-28,top:-15,bottom:15,strokeWidth:this.strokeWidth});var t=this.x2-this.x1,n=Math.atan2(this.y2-this.y1,t);e.translate((this.x2-this.x1)/2,(this.y2-this.y1)/2),e.rotate(n);var r=this.strokeWidth-this.oldArrowInfo.strokeWidth;e.lineJoin=this.strokeLineJoin,e.lineCap=this.strokeLineCap,e.strokeStyle=this.stroke,e.beginPath(),e.moveTo(0,0),e.lineTo(this.oldArrowInfo.left-r,this.oldArrowInfo.bottom+r),e.lineTo(this.oldArrowInfo.left-r,this.oldArrowInfo.top-r),e.closePath(),e.fillStyle=this.stroke,e.fill(),e.stroke(),e.restore()},setStrokeWidth(e){this.set("strokeWidth",e)},setStrokeDashArray(e){this.set("strokeDashArray",e)},setStrokeLineCap(e){this.set("strokeLineCap",e?"round":"butt"),this.set("strokeLineJoin",e?"round":"miter")},toObject(e){return ih(this.callSuper("toObject",e),{x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2})}}),es.fabric.FArrow.fromObject=function(e,t){t&&t(new es.fabric.FArrow([e.x1,e.y1,e.x2,e.y2],e))}},ip=function(){es.fabric.FTriArrow=es.fabric.util.createClass(es.fabric.Line,{type:"f-tri-arrow",borderColor:"#00000000",_render:function(e){this.callSuper("_render",e),e.save(),this.oldArrowInfo||(this.oldArrowInfo={left:-24,top:-16,bottom:16,strokeWidth:this.strokeWidth});var t=this.x2-this.x1,n=Math.atan2(this.y2-this.y1,t);e.translate((this.x2-this.x1)/2,(this.y2-this.y1)/2),e.rotate(n);var r=this.strokeWidth-this.oldArrowInfo.strokeWidth;e.lineJoin=this.strokeLineJoin,e.lineCap=this.strokeLineCap,e.strokeStyle=this.stroke,e.beginPath(),e.moveTo(this.oldArrowInfo.left-r,this.oldArrowInfo.bottom+r),e.lineTo(0,0),e.lineTo(this.oldArrowInfo.left-r,this.oldArrowInfo.top-r),e.fillStyle="#00000000",e.fill(),e.stroke(),e.restore()},setStrokeWidth(e){this.set("strokeWidth",e)},setStrokeDashArray(e){this.set("strokeDashArray",e)},setStrokeLineCap(e){this.set("strokeLineCap",e?"round":"butt"),this.set("strokeLineJoin",e?"round":"miter")},toObject(e){return ih(this.callSuper("toObject",e),{x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2})}}),es.fabric.FTriArrow.fromObject=function(e,t){t&&t(new es.fabric.FTriArrow([e.x1,e.y1,e.x2,e.y2],e))}},iv=function(){function e(t){(0,r4._)(this,e),(0,r5._)(this,"canvas",void 0),(0,r5._)(this,"_options",void 0),(0,r5._)(this,"_template",void 0),(0,r5._)(this,"sketch",void 0),(0,r5._)(this,"_resizeObserver",void 0),(0,r5._)(this,"_pan",void 0),(0,r5._)(this,"fhistory",void 0),(0,r5._)(this,"autoSave",void 0);var n=t.template,r=(0,V._)(t,["template"]);this._options=r,this._template=n,this._pan={enable:!1,isDragging:!1,lastPosX:0,lastPosY:0}}return(0,r8._)(e,[{key:"init",value:function(){var e=this;return(0,k._)(function(){return(0,Z.Jh)(this,function(t){switch(t.label){case 0:return e._initObject(),e._initCanvas(),e._initEvents(),e._initSketch(),e._initGuidelines(),e.autoSave=new ir(e),[4,e.autoSave.loadFromLocal()];case 1:var n,r,i;return t.sent(),e.fhistory=new it(e),n=e.canvas,r=e.fhistory,(0,ie.Z)("ctrl+c,command+c",(i=(0,k._)(function(e){return(0,Z.Jh)(this,function(e){switch(e.label){case 0:return[4,ni(n,null)];case 1:return e.sent(),[2]}})}),function(e){return i.apply(this,arguments)})),(0,ie.Z)("ctrl+v,command+v",function(e){no(n)}),(0,ie.Z)("delete,del,backspace",function(e){e.preventDefault(),na(null,n)}),(0,ie.Z)("ctrl+z,command+z",function(e){e.preventDefault(),r.undo()}),(0,ie.Z)("ctrl+shift+z,command+shift+z",function(e){e.preventDefault(),r.redo()}),(0,ie.Z)("up, right, down, left",function(e,t){var r=n.getActiveObject();if(r&&("f-text"!==r.type||!r.isEditing)){switch(e.preventDefault(),t.key){case"up":r.set("top",r.top-1);break;case"right":r.set("left",r.left+1);break;case"down":r.set("top",r.top+1);break;case"left":r.set("left",r.left-1)}r.group&&r.addWithUpdate(),n.requestRenderAll()}}),e.autoSave.init(),[2]}})})()}},{key:"_initObject",value:function(){r7(),il(),is(),iu(),id(),ip(),t7(),t9(),ne(),tI(),tY(),tN()}},{key:"_initCanvas",value:function(){var e=this._options,t=e.canvasEl,n=e.workspaceEl;this.canvas=new es.fabric.Canvas(t,{selection:!0,containerClass:"fabritor-canvas",enableRetinaScaling:!0,fireRightClick:!0,controlsAboveOverlay:!0,width:n.offsetWidth,height:n.offsetHeight,backgroundColor:"#dddddd",preserveObjectStacking:!0,imageSmoothingEnabled:!1})}},{key:"_initGuidelines",value:function(){var e,t,n,r,i,o,a,l,s,c,u,h,f;e=this.canvas,t=function(e){r(e.x+.5,e.y1>e.y2?e.y2:e.y1,e.x+.5,e.y2>e.y1?e.y2:e.y1)},n=function(e){r(e.x1>e.x2?e.x2:e.x1,e.y+.5,e.x2>e.x1?e.x2:e.x1,e.y+.5)},r=function(e,t,n,r){a.save(),a.lineWidth=s,a.strokeStyle=c,a.beginPath(),a.moveTo(e*u+o[4],t*u+o[5]),a.lineTo(n*u+o[4],r*u+o[5]),a.stroke(),a.restore()},i=function(e,t){e=Math.round(e),t=Math.round(t);for(var n=e-l,r=e+l;n<=r;n++)if(n===t)return!0;return!1},a=e.getSelectionContext(),l=4,s=1,c="rgb(0,255,0)",u=1,h=[],f=[],e.on("mouse:down",function(){o=e.viewportTransform,u=e.getZoom()}),e.on("object:moving",function(t){var n=t.target,r=e.getObjects(),a=n.getCenterPoint(),l=a.x,s=a.y,c=n.getBoundingRect(),u=c.height/o[3],d=c.width/o[0],p=!1,v=!1;if(e._currentTransform){for(var g=r.length;g--;)if(r[g]!==n){var m=r[g].getCenterPoint(),b=m.x,y=m.y,k=r[g].getBoundingRect(),w=k.height/o[3],Z=k.width/o[0];i(b,l)&&(v=!0,h.push({x:b,y1:y<s?y-w/2-5:y+w/2+5,y2:s>y?s+u/2+5:s-u/2-5}),n.setPositionByOrigin(new fabric.Point(b,s),"center","center")),i(b-Z/2,l-d/2)&&(v=!0,h.push({x:b-Z/2,y1:y<s?y-w/2-5:y+w/2+5,y2:s>y?s+u/2+5:s-u/2-5}),n.setPositionByOrigin(new fabric.Point(b-Z/2+d/2,s),"center","center")),i(b+Z/2,l+d/2)&&(v=!0,h.push({x:b+Z/2,y1:y<s?y-w/2-5:y+w/2+5,y2:s>y?s+u/2+5:s-u/2-5}),n.setPositionByOrigin(new fabric.Point(b+Z/2-d/2,s),"center","center")),i(y,s)&&(p=!0,f.push({y:y,x1:b<l?b-Z/2-5:b+Z/2+5,x2:l>b?l+d/2+5:l-d/2-5}),n.setPositionByOrigin(new fabric.Point(l,y),"center","center")),i(y-w/2,s-u/2)&&(p=!0,f.push({y:y-w/2,x1:b<l?b-Z/2-5:b+Z/2+5,x2:l>b?l+d/2+5:l-d/2-5}),n.setPositionByOrigin(new fabric.Point(l,y-w/2+u/2),"center","center")),i(y+w/2,s+u/2)&&(p=!0,f.push({y:y+w/2,x1:b<l?b-Z/2-5:b+Z/2+5,x2:l>b?l+d/2+5:l-d/2-5}),n.setPositionByOrigin(new fabric.Point(l,y+w/2-u/2),"center","center"))}p||(f.length=0),v||(h.length=0)}}),e.on("before:render",function(){e.contextTop&&e.clearContext(e.contextTop)}),e.on("after:render",function(){for(var e=h.length;e--;)t(h[e]);for(var e=f.length;e--;)n(f[e]);h.length=f.length=0}),e.on("mouse:up",function(){h.length=f.length=0,e.renderAll()}),function(e){for(var t,n,r,i=function(){a(c+.5,0,c+.5,s)},o=function(){a(0,u+.5,l,u+.5)},a=function(e,t,n,i){v.save(),v.strokeStyle=d,v.lineWidth=p,v.beginPath(),v.moveTo(e*r[0],t*r[3]),v.lineTo(n*r[0],i*r[3]),v.stroke(),v.restore()},l=e.getWidth(),s=e.getHeight(),c=l/2,u=s/2,h={},f={},d="rgba(255,0,241,0.5)",p=1,v=e.getSelectionContext(),g=c-4,m=c+4;g<=m;g++)h[Math.round(g)]=!0;for(var g=u-4,m=u+4;g<=m;g++)f[Math.round(g)]=!0;e.on("mouse:down",function(){r=e.viewportTransform}),e.on("object:moving",function(r){var i=r.target,o=i.getCenterPoint();e._currentTransform&&(t=Math.round(o.x) in h,((n=Math.round(o.y) in f)||t)&&i.setPositionByOrigin(new fabric.Point(t?c:o.x,n?u:o.y),"center","center"))}),e.on("before:render",function(){e.contextTop&&e.clearContext(e.contextTop)}),e.on("after:render",function(){t&&i(),n&&o()}),e.on("mouse:up",function(){t=n=null,e.renderAll()})}(this.canvas)}},{key:"_initSketch",value:function(){var e=this._template||{},t=e.width,n=e.height,r=new es.fabric.Rect({fill:"#ffffff",left:0,top:0,width:void 0===t?1242:t,height:void 0===n?1660:n,selectable:!1,hasControls:!1,hoverCursor:"default",id:eg,fabritor_desc:ee("header.fabritor_desc")});this.canvas.add(r),this.canvas.requestRenderAll(),this.sketch=r,this._initResizeObserver(),this._adjustSketch2Canvas()}},{key:"setSketchSize",value:function(e){this.sketch.set(e),this._adjustSketch2Canvas()}},{key:"_initResizeObserver",value:function(){var e=this,t=this._options.workspaceEl;this._resizeObserver=new ResizeObserver((0,r9.Z)(function(){e.canvas.setWidth(t.offsetWidth),e.canvas.setHeight(t.offsetHeight),e._adjustSketch2Canvas()},50)),this._resizeObserver.observe(t)}},{key:"_adjustSketch2Canvas",value:function(){var e,t,n=this,r=(e={width:this.canvas.width,height:this.canvas.height},(t={width:this.sketch.width,height:this.sketch.height}).width<e.width&&t.height<=e.height?1:Number((e.width/e.height<t.width/t.height?e.width/t.width:e.height/t.height).toFixed(2))),i=this.canvas.getCenter();this.canvas.zoomToPoint(new es.fabric.Point(i.left,i.top),r-.04);var o=this.sketch.getCenterPoint(),a=this.canvas.viewportTransform;a[4]=this.canvas.width/2-o.x*a[0],a[5]=this.canvas.height/2-o.y*a[3],this.canvas.setViewportTransform(a),this.canvas.requestRenderAll(),this.sketch.clone(function(e){n.canvas.clipPath=e,n.canvas.requestRenderAll()})}},{key:"_initEvents",value:function(){var e=this;this.canvas.on("mouse:down",function(t){var n=t.e;e._pan.enable&&(e._pan={enable:!0,isDragging:!0,lastPosX:n.clientX,lastPosY:n.clientY})}),this.canvas.on("mouse:move",function(t){if(e._pan.enable&&e._pan.isDragging){var n=t.e,r=e.canvas.viewportTransform;r[4]+=n.clientX-e._pan.lastPosX,r[5]+=n.clientY-e._pan.lastPosY,e.canvas.requestRenderAll(),e._pan.lastPosX=n.clientX,e._pan.lastPosY=n.clientY}}),this.canvas.on("mouse:over",function(t){var n=t.target;if(!e._pan.enable){var r=null==n?void 0:n.__corner;r&&nt(r,t.target),n&&n.id!==eg&&n!==e.canvas.getActiveObject()&&n._renderControls(e.canvas.contextTop,{hasControls:!1})}}),this.canvas.on("mouse:out",function(t){var n=t.target;n&&n.id!==eg&&(nn(n),e.canvas.requestRenderAll())}),this.canvas.on("mouse:up",function(t){e._pan.enable&&(e.canvas.setViewportTransform(e.canvas.viewportTransform),e._pan.isDragging=!1)}),this.canvas.on("mouse:wheel",this._scrollSketch.bind(this)),this.canvas.on("mouse:dblclick",function(t){var n=t.target,r=t.subTargets,i=null==r?void 0:r[0];(null==n?void 0:n.type)==="group"&&i&&"f-text"===i.type&&e._editTextInGroup(n,i)}),this.canvas.on("object:modified",function(t){var n=t.target;if(n&&n.id!==eg){var r=n.getScaledWidth(),i=n.getScaledHeight();"f-line"!==n.type&&"f-image"!==n.type&&("f-text"!==n.type&&(n.setControlVisible("mt",r>=100),n.setControlVisible("mb",r>=100)),n.setControlVisible("ml",i>=40),n.setControlVisible("mr",i>=40),e.canvas.requestRenderAll()),("f-line"===n.type||"f-arrow"===n.type||"f-tri-arrow"===n.type)&&nf(t)}})}},{key:"_editTextInGroup",value:function(e,t){var n=this,r=e.getObjects();t.on("editing:exited",function(){for(var e=0;e<r.length;e++)n.canvas.remove(r[e]);var i=ii({items:r,canvas:n.canvas});n.canvas.renderAll(),n.canvas.setActiveObject(i),n.canvas.fire("fabritor:group",{target:n.canvas.getActiveObject()}),t.off("editing:exited")}),e._restoreObjectsState(),this.canvas.remove(e),this.canvas.renderAll();for(var i=0;i<r.length;i++)r[i].selectable=!1,r[i].set("hasControls",!1),this.canvas.add(r[i]);this.canvas.renderAll(),this.canvas.setActiveObject(t),t.enterEditing(),t.selectAll()}},{key:"switchEnablePan",value:function(){var e=this;return this._pan.enable=!this._pan.enable,this.canvas.discardActiveObject(),this.canvas.hoverCursor=this._pan.enable?"grab":"move",this.canvas.getObjects().forEach(function(t){t.id!==eg&&t.set("selectable",!e._pan.enable)}),this.canvas.selection=!this._pan.enable,this.canvas.requestRenderAll(),this._pan.enable}},{key:"getIfPanEnable",value:function(){return this._pan.enable}},{key:"fireCustomModifiedEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.canvas.fire("fabritor:object:modified",e)}},{key:"_scrollSketch",value:function(e){var t=e.e.deltaY,n=this.canvas.getZoom();(n*=Math.pow(.999,t))>20&&(n=20),n<.01&&(n=.01);var r=this.canvas.getCenter();this.canvas.zoomToPoint({x:r.left,y:r.top},n),e.e.preventDefault(),e.e.stopPropagation()}},{key:"destroy",value:function(){this.canvas&&(this.canvas.dispose(),this.canvas=null),this.fhistory&&this.fhistory.dispose(),this.autoSave&&this.autoSave.dispose();var e=this._options.workspaceEl;this._resizeObserver&&(this._resizeObserver.unobserve(e),this._resizeObserver=null)}},{key:"export2Img",value:function(e){var t=this,n=this.canvas.viewportTransform,r=this.canvas.clipPath;this.canvas.setViewportTransform([1,0,0,1,0,0]),this.canvas.setBackgroundColor("#ffffff"),this.canvas.clipPath=null;var i=this.sketch,o=i.left,a=i.top,l=i.width,s=i.height,c=this.canvas.toDataURL((0,I._)({left:o,top:a,width:l,height:s,format:"png"},e));return this.canvas.setViewportTransform(n),this.canvas.clipPath=r,this.canvas.setBackgroundColor("#dddddd",function(){t.canvas.requestRenderAll()}),c}},{key:"export2Svg",value:function(){var e=this.sketch,t=e.left,n=e.top,r=e.width,i=e.height,o=this.canvas.toSVG({width:r,height:i,viewBox:{x:t,y:n,width:r,height:i}});return"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(o))}},{key:"canvas2Json",value:function(){var e=this.canvas.toJSON(em);return e[eh]=3.1,e}},{key:"loadFromJSON",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return(0,k._)(function(){var r,i,o,a,l,s,c,u,h,f;return(0,Z.Jh)(this,function(d){switch(d.label){case 0:if(!e)return[2,!1];if("string"==typeof e)try{e=JSON.parse(e)}catch(p){return console.log(p),t&&er.ZP.error("\u52A0\u8F7D\u672C\u5730\u6A21\u677F\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),[2,!1]}if(3.1!==e[eh])return console.warn("\u6B64\u6A21\u677F\u5DF2\u7ECF\u65E0\u6CD5\u4E0E\u5F53\u524D\u7248\u672C\u517C\u5BB9\uFF0C\u8BF7\u66F4\u6362\u6A21\u677F"),[2,!1];return[3,8];case 1:d.trys.push([1,6,7,8]),l=r[Symbol.iterator](),d.label=2;case 2:if(i=(s=l.next()).done)return[3,5];if("f-text"!==(c=s.value).type)return[3,4];return[4,eb(c.fontFamily)];case 3:d.sent(),d.label=4;case 4:return i=!0,[3,2];case 5:return[3,8];case 6:return u=d.sent(),o=!0,a=u,[3,8];case 7:try{i||null==l.return||l.return()}finally{if(o)throw a}return[7];case 8:return h=n.canvas.getActiveObject(),n.autoSave.setCanSave(!1),[2,new Promise(function(t){n.canvas.loadFromJSON(e,function(){n.canvas.requestRenderAll(),n.autoSave.setCanSave(!0),n.canvas.fire("fabritor:load:json",{lastActiveObject:f}),t(!0)},function(e,t){t.id===eg&&(n.sketch=t,n.setSketchSize({width:t.width,height:t.height})),t.id===(null==h?void 0:h.id)&&(f=t)})})]}})})()}},{key:"clearCanvas",value:function(){var e=this;return(0,k._)(function(){var t,n,r,i,o;return(0,Z.Jh)(this,function(a){switch(a.label){case 0:return n=(t=e.sketch).width,r=t.height,i=t.fabritor_desc,o='{"fabritor_schema_version":3,"version":"5.3.0","objects":[{"type":"rect","version":"5.3.0","originX":"left","originY":"top","left":0,"top":0,"width":'.concat(n,',"height":').concat(r,',"fill":"#ffffff","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"stroke","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"rx":0,"ry":0,"id":"fabritor-sketch","fabritor_desc":"').concat(i,'","selectable":false,"hasControls":false}],"clipPath":{"type":"rect","version":"5.3.0","originX":"left","originY":"top","left":0,"top":0,"width":').concat(n,',"height":').concat(r,',"fill":"#ffffff","stroke":null,"strokeWidth":1,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":true,"strokeMiterLimit":4,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"stroke","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"rx":0,"ry":0,"selectable":true,"hasControls":true},"backgroundColor":"#dddddd"}'),[4,e.loadFromJSON(o)];case 1:return a.sent(),e.fhistory.reset(),[2]}})})()}}]),e}(),ig=function(){var e=(0,w._)((0,x.useState)({left:0,top:0}),2),t=e[0],n=e[1],r=(0,w._)((0,x.useState)(""),2),i=r[0],o=r[1],a=(0,w._)((0,x.useState)(!1),2),l=a[0],s=a[1],c=(0,x.useContext)(j).editor,u=function(e){var t=e.target,r=e.e;n({left:r.pageX+16,top:r.pageY}),o("".concat(Math.round(t.angle),"\xb0")),s(!0)},h=function(){s(!1)};return(0,x.useEffect)(function(){c&&(c.canvas.on("object:rotating",u),c.canvas.on("mouse:up",h))},[c]),(0,b.tZ)("div",{style:(0,I._)({fontSize:12,position:"fixed",zIndex:9999,width:"max-content",display:l?"block":"none"},t),children:(0,b.tZ)(to.Z,{color:"rgba(0, 0, 0, 0.85)",children:i})})},im=n(6724),ib=C.Z.Content,iy={background:"#ddd",width:"100%",height:"100%",overflow:"hidden",flex:1},ik={display:"flex",flexDirection:"column",height:"100%"};function iw(){var e,t=(0,x.useRef)(null),n=(0,x.useRef)(null),r=(0,x.useRef)(null),i=(0,w._)((0,x.useState)(null),2),o=i[0],a=i[1],l=(0,w._)((0,x.useState)(),2),s=l[0],c=l[1],u=(0,w._)((0,x.useState)(null),2),h=u[0],f=u[1],d=(0,w._)((0,x.useState)(!1),2),p=d[0],v=d[1],g=(0,x.useRef)(null),m=function(e){var t,n,r=e.target;if(!o.getIfPanEnable()){if(!r){null===(t=g.current)||void 0===t||t.hide();return}3===e.button?(r.id!==eg&&o.canvas.setActiveObject(r),setTimeout(function(){var e;null===(e=g.current)||void 0===e||e.show()},50)):null===(n=g.current)||void 0===n||n.hide()}},y=function(e){var t=e.selected,n=e.sketch;t&&t.length?f(o.canvas.getActiveObject()):f(n)},S=function(){f(o.canvas.getActiveObject())},A=function(e){var t=e.lastActiveObject;t&&(o.canvas.setActiveObject(t),f(t))},O=function(){o.canvas.on("selection:created",y),o.canvas.on("selection:updated",y),o.canvas.on("selection:cleared",y),o.canvas.on("mouse:down",m),o.canvas.on("fabritor:group",S),o.canvas.on("fabritor:ungroup",S),o.canvas.on("fabritor:load:json",A)},z=(e=(0,k._)(function(){var e;return(0,Z.Jh)(this,function(r){switch(r.label){case 0:return[4,(e=new iv({canvasEl:t.current,workspaceEl:n.current,sketchEventHandler:{groupHandler:function(){f(e.canvas.getActiveObject())}}})).init()];case 1:return r.sent(),a(e),v(!0),f(e.sketch),[2]}})}),function(){return e.apply(this,arguments)}),F=function(){c(im.Z.svg(r.current))};return(0,x.useEffect)(function(){o&&(O(),F())},[o]),(0,x.useEffect)(function(){return z(),function(){o&&o.destroy()}},[]),(0,b.tZ)(j.Provider,{value:{object:h,setActiveObject:f,isReady:p,setReady:v,editor:o,roughSvg:s},children:(0,b.BX)(C.Z,{style:{height:"100%"},className:"fabritor-layout",children:[(0,b.tZ)(_.Z,{spinning:!p,fullscreen:!0}),(0,b.tZ)(ig,{}),(0,b.tZ)(eE,{}),(0,b.BX)(C.Z,{children:[(0,b.tZ)(nX,{}),(0,b.tZ)(ib,{style:ik,children:(0,b.tZ)(np,{ref:g,object:h,children:(0,b.tZ)("div",{style:iy,ref:n,className:"fabritor-workspace",children:(0,b.tZ)("canvas",{ref:t})})})}),(0,b.tZ)(r6,{})]}),(0,b.tZ)("svg",{id:"fabritor-rough-svg",ref:r})]})})}var iZ=(0,y.Cv)(function(){return{title:"fabritor, A creative editor based on fabricjs."}});function ix(){return(0,b.tZ)(iw,{})}},4960:function(){},6759:function(){},6272:function(){}}]);